{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/core/helpers.ts","webpack:///./src/ui/routes.ts","webpack:///./src/api/routes/routes.ts","webpack:///./src/ui/components/home/list.tsx","webpack:///./src/ui/components/home/home.tsx","webpack:///./src/ui/error.tsx","webpack:///./src/ui/components/common/NavbarLink.tsx","webpack:///./src/ui/components/navbar/navbar.tsx","webpack:///./src/ui/components/offacanvas/offcanvas.tsx","webpack:///./src/core/models.ts","webpack:///./src/core/statics.ts","webpack:///./src/app/flow/actions.ts","webpack:///./src/ui/components/common/BpdActionIcon.tsx","webpack:///./src/core/validators.ts","webpack:///./src/ui/components/common/BpdDialog.tsx","webpack:///./src/ui/components/common/ErrorsList.tsx","webpack:///./src/ui/components/actions/AddActionDialog.tsx","webpack:///./src/ui/components/common/PageHeader.tsx","webpack:///./src/ui/components/common/ClearableInput.tsx","webpack:///./src/ui/components/actions/StopwatchActionsComponent.tsx","webpack:///./src/ui/components/common/Dialogs.ts","webpack:///./src/ui/components/common/GoBack.tsx","webpack:///./src/ui/components/common/NotFound.tsx","webpack:///./src/ui/components/actions/ActionsSelect.tsx","webpack:///./src/ui/components/trainings/EditRoundDialog.tsx","webpack:///./src/ui/components/trainings/EditRoundListItem.tsx","webpack:///./src/ui/components/trainings/EditTraining.tsx","webpack:///./src/api/screen/screen.ts","webpack:///./src/api/stopwatch/stopwatch.ts","webpack:///./src/app/flow/settings.ts","webpack:///./src/ui/components/perform/CountDownTimer.tsx","webpack:///./src/ui/components/perform/PerformTraining.tsx","webpack:///./src/app/flow/trainings.ts","webpack:///./src/ui/components/settings/SettingsDevTools.tsx","webpack:///./src/ui/components/settings/SettingsSwitchListItem.tsx","webpack:///./src/ui/components/settings/StopwatchSettings.tsx","webpack:///./src/ui/components/about/About.tsx","webpack:///./src/ui/components/footer/Footer.tsx","webpack:///./src/ui/app.tsx","webpack:///../cui-light/dist/esm/managers/element.js","webpack:///./src/core/services/storage.tsx","webpack:///../cui-light/dist/esm/builders/dialog.js","webpack:///../cui-light/dist/esm/handlers/alert.js","webpack:///../cui-light/dist/esm/observers/move.js","webpack:///../cui-light/dist/esm/managers/toast.js","webpack:///../cui-light/dist/esm/helpers/collection.js","webpack:///../cui-light/dist/esm/managers/collection.js","webpack:///../cui-light/dist/esm/managers/plugins.js","webpack:///../cui-light/dist/esm/instance.js","webpack:///../cui-light/dist/esm/initializer.js","webpack:///../cui-light/dist/esm/init.js","webpack:///./src/index.tsx"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","showMessage","title","message","$cui","alert","calculateDuration","actions","is","reduce","Number","parseInt","duration","calcDisplayTimer","seconds","getDisplayTimerValue","restSeconds","Math","floor","secondsLeft","setDarkMode","darkMode","getUtils","setLightMode","calculateProgress","current","max","getTotalDuration","training","rounds","getBgClassByType","type","getClassByType","move","collection","from","to","size","amount","el","newLength","newTo","MAPPIGNS","routes","this","id","undefined","route","getRoute","url","attributes","uri","getUrl","enumerateObject","prop","replace","TrainingList","props","className","list","map","item","TrainingListItem","onDelete","history","useHistory","React","deleteSubscription","$flow","subscribe","finish","perform","unsubscribe","onClick","renderUrl","toUpperCase","getActionsDuration","cui-icon","cui-tooltip","Home","state","updateList","onDeleteTrainingComplete","deleteTraining","subscription","onDeleteSubscription","elementIdx","findIndex","onYes","flag","setState","NoTrainings","ErrorRoute","NavbarLink","shouldClose","emit","exact","activeClassName","Navbar","currentLocation","useLocation","currentSite","soundEnabled","split","pathname","toLocaleUpperCase","cui-open","class","getName","OffCanvas","cui-off-canvas","href","cui-close","StopwatchActionType","DefaultActions","removable","editable","ERROR_CODES","getDefaultRoundName","index","ACTIONS_FLOW_ACTIONS","ActionsFlow","service","getAllActions","action","setAction","removeAction","clearActions","BpdActionIcon","data-tooltip","ValidatorBase","status","errors","performValidation","e","errorMsg","console","error","TrainingValidator","RoundValidator","ActionValidator","BpdDialog","cui-dialog","body","footer","ErrorsList","AddActionDialog","setErrors","onValueChange","event","target","checked","placeholder","onChange","min","htmlFor","onSave","actionValidator","validate","dialogCui","PageHeader","description","ClearableInput","setValue","changeValue","onUpdate","ev","defaultAction","StopwatchActionsComponent","filter","setFilter","onConfirm","$actionsFlow","onGetAll","onAddOrEditClick","getAllSub","setActionSub","removeActionSub","match","toLowerCase","matchesName","preventDefault","withRouter","goBack","NotFound","classes","ActionsSelect","onSelect","find","EditRoundDialog","useState","selected","setStateRoundData","definedActions","round","currentCount","newActions","onDeleteAction","validation","EditRoundListItem","isFirst","onMoveUp","isLast","onMoveDown","onClone","onEdit","EditTrainingSection","currentIndex","currentRound","setDefinedActions","onRoundEdit","onRoundDelete","onOnfirm","updateRoundsState","onRoundDown","onRoundUp","onRoundClone","idx","cloned","clone","insert","onFormChange","includes","getDefinedActions","getDefinedActionsSub","rows","arr","updateOrInsertRound","useParams","onUpdateTraining","onGetTraining","onDeleteTraining","onDeleteTrainingSub","log","updateTrainingSub","getTrainingSub","deleteTraininSub","onCancel","validaton","join","KeepAwakeToggle","screen","keepAwake","LoopLockScreen","element","createElement","document","appendChild","remove","src","newEl","autoplay","muted","loop","classList","add","textContent","KeepScreenAwakeFeature","getToggle","activate","release","StopWatchStateOptions","StopWatch","callback","setTimeout","tick","stop","clearTimeout","SETTINGS_FLOW_ACTIONS","SettingsFlow","isSoundEnabled","setSoundEnabled","isDarkMode","setSettings","getSettings","isWelcomeSet","setIsWelcome","clearSettings","CountDownTimer","cui-circle-progress","watchState","trainingProgress","roundProgress","progress","actionIdx","timerCls","timer","defaultCurrent","roundIdx","roundDuration","totalDuration","PerfromTraining","stopwatch","setStopwatch","setCurrent","canPlay","setCanPlay","startBtnCls","getStartBtnCls","setWatchState","errorMessage","setErrorMessage","currentRef","trainingRef","countdownSound","endSound","roundValidator","setDefaultCurrentState","onStopwatchTick","currentTime","total","ct","setStopWatchState","getState","time","play","reset","nextActionIdx","newAction","nextRoundIdx","newRound","setNextAction","watchstate","timeData","act","calculateRoundCurrentTime","trainginProgress","calculateTrainingProgress","onGetPlaySound","getTrainingSubscription","settingsPlaySound","$settingsFlow","wakeLock","onTick","pause","resume","start","ref","ACTIONS","TrainingsFlow","getAllTrainings","addTraining","updateTraining","getTraining","clearTrainings","SettingsDevTools","onClear","toast","onSettingsUpdate","settingsClearSub","actionsClearSub","trainingsClearSub","SettingsSwitchListItem","label","StopwatchSettings","isWelcome","settings","newSettings","onUpdateSettings","onGetSettings","settingsSub","settingsUpdateSub","About","Footer","Date","getFullYear","App","darkModeSub","onDarkMode","welcomeScreenGetSub","onWelcomeScreen","welcomeDialogHandle","welcomeDialogCloseEventIds","on","onWelcomeDialogClose","forEach","detach","path","component","EditTraining","_elements","_isLocked","_logger","_cDt","_utils","_actionsHelper","TrainingsStorageService","BpdStorage","getTrainings","onAction","getNextIndex","trainings","Error","res","getAny","setAny","getNumber","NaN","setNumber","setTrainings","ActionStorageService","getActionsFromStorage","existingIndex","getIndex","setActionsToStorage","val","SettingsService","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","step","next","rejected","done","then","__classPrivateFieldSet","receiver","privateMap","has","TypeError","set","__classPrivateFieldGet","elements","utils","now","interactions","contains","fetch","mutate","attributeName","attr","getAttribute","attributeValue","setAttribute","removeAttribute","hasAttribute","addEventListener","eventName","functionName","lock","unlock","timeout","delay","setup","animationTime","change","animProgress","openClass","animationClass","performAction","closeClass","args","cuid","$cuid","debug","bus","warning","ids","cuiElement","disposeId","WeakMap","_header","_body","_footer","_prefix","_switches","_reverse","prefix","reverse","switches","headerBuilder","setClasses","build","titleElement","getPrefixedString","appendChildrens","dialog","setId","setAttributes","container","parent","str","_callbacks","_manager","_attid","_id_1","_id_2","_id_3","onNo","onOk","content","closeStr","iconStr","root","getElementById","updateElement","onClose","querySelector","innerHTML","arg","_a","super","dialogBuilder","createHeader","createBody","createFooter","_bus","_moveListener","_eventId","_firstEvent","setCallback","onMove","isAttached","attach","MOVE_LOCK","onMoveLock","GLOBAL_MOVE","_interactions","_selector","_className","_activeCls","_animationTime","_lock","_animClsIn","_animClsOut","interaction","toastElement","_log","_toggleClass","currentElement","nextElement","animIn","animOut","count","newIndex","animClassIn","animClassOut","addAnimationClass","setFinalClasses","len","_helper","setElements","setToggle","check","newIdx","getCurrentIndex","verifyIndex","setCurrentWithAnimation","_plugins","_mutated","plugins","plugin","mutation","init","tasks","all","_mutationObserver","_toastManager","_components","_rootElement","_moveObserver","_mutatedAttributes","components","logLevel","MutationObserver","animationTimeLong","x","attribute","initElements","querySelectorAll","exception","setComponents","setPlugins","setProperty","animationTimeShort","INSTANCE_INITIALIZED","INSTANCE_FINISHED","selector","show","nodes","detachAll","popup","_window","_b","assign","appPrefix","app","icons","icon","swipeAnimations","animation","_isInitialized","rootElement","app_icons","require","CuiSetupInit","busSetup","eventsDef","handler","priority","cuiSetup","CuiIconsPack","traningsFlow","actionsFlow","settingsFlow","FlowFactory","getActions","initializer","pluginList","autoLight","autoPrint","componentList","appPlugins","ReactDOM"],"mappings":"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","file":"stopwatch.index.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([46,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import { is } from \"bpd-toolkit/dist/esm/index\";\r\nimport { Round, StopwatchAction, Training } from \"./models\";\r\n\r\nexport function showMessage(title: string, message: string) {\r\n    window.$cui.alert(\"common-info-dialog\", \"Info\", {\r\n        title: title,\r\n        message: message\r\n    })\r\n}\r\n\r\nexport function calculateDuration(actions: StopwatchAction[]) {\r\n    return is(actions) ? actions.reduce<number>((result: number, value: StopwatchAction) => {\r\n        return result + Number.parseInt(value.duration);\r\n    }, 0) : 0\r\n}\r\n\r\nexport function calcDisplayTimer(seconds: number): string {\r\n    if (seconds < 0) {\r\n        return \"Error\"\r\n    }\r\n    if (seconds < 60) {\r\n        return \"00:\" + getDisplayTimerValue(seconds)\r\n    } else if (seconds < 3600) {\r\n        let minutes = Math.floor(seconds / 60);\r\n        let restSeconds = seconds % 60;\r\n        return getDisplayTimerValue(minutes) + \":\" + getDisplayTimerValue(restSeconds);\r\n    } else {\r\n        let hours = Math.floor(seconds / 3600);\r\n        let secondsLeft = seconds % 3600\r\n        return getDisplayTimerValue(hours) + \":\" + calcDisplayTimer(secondsLeft);\r\n    }\r\n}\r\n\r\nexport function getDisplayTimerValue(value: number): string {\r\n    if (value < 0 || value > 59) {\r\n        return \"Error\";\r\n    }\r\n    return value < 10 ? \"0\" + value : \"\" + value;\r\n}\r\n\r\nexport function setDarkMode(darkMode: boolean) {\r\n    if (window.$cui) {\r\n        let utils = window.$cui.getUtils();\r\n        utils.setLightMode(darkMode ? \"dark\" : \"light\");\r\n    }\r\n}\r\n\r\nexport function calculateProgress(current: number, max: number) {\r\n    return Math.floor((current * 100) / max);\r\n}\r\n\r\n/**\r\n * Calculates total actions count and total duration of the training\r\n * @param training \r\n * @returns total actions count and total duration\r\n */\r\nexport function getTotalDuration(training: Training) {\r\n    return training.rounds.reduce<[number, number]>((result: [number, number], current: Round) => {\r\n        return [result[0] + current.actions.length, result[1] + calculateDuration(current.actions)];\r\n    }, [0, 0]);\r\n}\r\n\r\nexport function getBgClassByType(type: string) {\r\n    return \"action-background-\" + type;\r\n}\r\n\r\nexport function getClassByType(type: string) {\r\n    switch (type) {\r\n        case 'warmup':\r\n            return \"cui-text-success\";\r\n        case 'break':\r\n            return \"cui-text-error\";\r\n        case 'exercise':\r\n            return \"cui-text-accent\";\r\n        case 'cooldown':\r\n            return \"cui-text-secondar\";\r\n        default:\r\n            return \"\";\r\n    }\r\n}\r\n\r\n/**\r\n * Inserts new item to the collection at specific index. If index is lower than 0 then item is added at position 0, if index is bigger than collection size then item is added at the end\r\n * @param collection Collection of items\r\n * @param index position which new item should be added to - if undefined or null provided item will be inserted at last position\r\n * @param t new items to add\r\n * @returns Copy of the collection with new item inserted at specific position\r\n */\r\nexport function insert<T>(collection: T[], index: number, ...t: T[]): T[] {\r\n    if (!collection || collection === null || !t || t === null || t.length === 0) {\r\n        return collection;\r\n    }\r\n    let length = collection.length;\r\n    // If not provided then add then treat it like last\r\n    if (!index || index === 0 || index >= length) {\r\n        return [...collection, ...t];\r\n    }\r\n    if (index <= 0) {\r\n        return [...t, ...collection];\r\n    }\r\n    collection.splice(index, 0, ...t);\r\n    return [...collection]\r\n}\r\n\r\nexport function move<T>(collection: T[], from: number, to: number, size?: number): T[] {\r\n    if (!collection || collection === null || from < 0) {\r\n        return collection;\r\n    }\r\n    let amount = size ?? 1;\r\n    let length = collection.length;\r\n    if (length < 2 || from >= length) {\r\n        return [...collection];\r\n    }\r\n    const el = collection.splice(from, amount);\r\n    const newLength = length - amount;\r\n    const newTo = to;\r\n    //let newIdx = newTo < 0 ? 0 : newTo > length - amount ? length - amount : newTo;\r\n    if (newTo <= 0) {\r\n        return [...el, ...collection];\r\n    }\r\n    if (newTo >= newLength) {\r\n        return [...collection, ...el];\r\n    }\r\n    collection.splice(newTo, 0, ...el)\r\n    return [...collection];\r\n\r\n}","import { AppMapping } from \"../api/routes/routes\";\r\n\r\nexport const MAPPIGNS = new AppMapping({\r\n    \"home\": { url: \"/\", name: \"Home\" },\r\n    \"about\": { url: \"/about\", name: \"About\" },\r\n    \"settings\": { url: \"/settings\", name: \"Settings\" },\r\n    \"actions\": { url: \"/actions\", name: \"Actions\" },\r\n    \"newTraining\": { url: \"/trainings/edit/new\", name: \"New Training\" },\r\n    \"editTraining\": { url: \"/trainings/edit/:id\", name: \"Edit Training\" },\r\n    \"perform\": { url: \"/trainings/perform/:id\", name: \"Perform Training\" }\r\n});","import { enumerateObject, is } from \"../../../node_modules/bpd-toolkit/dist/esm/index\";\r\n\r\n\r\nexport interface RouteDetails {\r\n    url: string,\r\n    name: string\r\n}\r\nexport interface RoutesMapping {\r\n    [id: string]: RouteDetails;\r\n}\r\n\r\nexport interface AppRouteAttributes {\r\n    [id: string]: string | number;\r\n}\r\n\r\nexport class AppMapping {\r\n    #mapping: RoutesMapping\r\n    constructor(routes: RoutesMapping) {\r\n        this.#mapping = routes;\r\n    }\r\n\r\n    getRoute(id: string) {\r\n        return is(id) ? this.#mapping[id] : undefined;\r\n    }\r\n\r\n    getUrl(id: string) {\r\n        let route = this.getRoute(id);\r\n        return is(route) ? route.url : undefined;\r\n    }\r\n\r\n    getName(id: string) {\r\n        let route = this.getRoute(id);\r\n        return is(route) ? route.name : undefined;\r\n    }\r\n    renderUrl(id: string, attributes?: AppRouteAttributes): string {\r\n        let uri = this.getUrl(id)\r\n        if (!is(attributes)) {\r\n            return uri;\r\n        }\r\n        enumerateObject(attributes, (prop: string, value: string) => {\r\n            uri = uri.replace(\":\" + prop, value);\r\n        })\r\n        return uri;\r\n    }\r\n}","import * as React from \"react\";\r\nimport { Round, Training } from \"../../../core/models\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport { calculateDuration } from \"../../../core/helpers\";\r\nimport { MAPPIGNS } from \"../../routes\";\r\n\r\nexport interface TrainingListProps {\r\n    list: Training[];\r\n    onDelete: (id: number) => void;\r\n}\r\n\r\nexport interface TrainingListItemProps {\r\n    data: Training;\r\n    onDelete: (id: number) => void;\r\n}\r\n\r\nexport function TrainingList(props: TrainingListProps) {\r\n    return <ul className=\"cui-list cui-hover\">\r\n        {props.list && props.list.map(item => {\r\n            return <li key={item.id} className=\"stopwatch-content-width cui-corner-round\"><TrainingListItem data={item} onDelete={props.onDelete} /></li>\r\n        })}\r\n    </ul>\r\n}\r\n\r\nexport function TrainingListItem(props: TrainingListItemProps) {\r\n    const deleteTrainingAction = \"DELETE_TRAINING\";\r\n    let history = useHistory();\r\n\r\n    function getActionsDuration(training: Training) {\r\n        return training.rounds.reduce<[number, number]>((result: [number, number], current: Round) => {\r\n            return [result[0] + current.actions.length, result[1] + calculateDuration(current.actions)];\r\n        }, [0, 0]);\r\n    }\r\n\r\n    function getDetails(training: Training) {\r\n        const [actions, duration] = getActionsDuration(training);\r\n        return `${duration} seconds`;\r\n    }\r\n\r\n    function onItemClick() {\r\n        history.push(MAPPIGNS.renderUrl(\"perform\", { id: props.data.id }))\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        const deleteSubscription = window.$flow.subscribe(deleteTrainingAction).finish((result) => {\r\n            window.$flow.perform(\"GET_TRAININGS\")\r\n        });\r\n\r\n        return () => {\r\n            window.$flow.unsubscribe(deleteTrainingAction, deleteSubscription.id)\r\n        }\r\n    })\r\n\r\n    return <div className=\"cui-flex cui-middle cui-animation-fade-in cui-padding-bottom cui-padding-top\">\r\n        <div className=\"cui-flex-grow\" onClick={onItemClick}>\r\n            <div className=\"cui-flex cui-middle cui-nowrap\">\r\n                <div className=\"training-list-item-icon\">\r\n                    <span className=\"cui-text-bold\">{props.data.name[0].toUpperCase()}</span>\r\n                </div>\r\n                <div className=\"cui-flex-grow cui-margin-left\">\r\n                    <span >{props.data.name}</span>\r\n                    <div className=\"cui-text-muted cui-text-truncate cui-overflow-hidden\">\r\n                        <span>{getDetails(props.data)}</span>\r\n                    </div></div>\r\n            </div>\r\n        </div>\r\n        <div className=\"cui-flex-shrink\">\r\n            <div>\r\n                <Link to={MAPPIGNS.renderUrl(\"editTraining\", { \"id\": props.data.id })} className=\"cui-icon-button\" cui-icon=\"edit\" cui-tooltip=\"Edit training\"></Link>\r\n            </div>\r\n        </div>\r\n    </div>\r\n}\r\n","import * as React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { TrainingList } from \"./list\";\r\nimport { Training, WarmUp, CoolDown, Exercise } from \"../../../core/models\";\r\nimport { FlowTask } from \"../../../../node_modules/bpd-flow/dist/index\";\r\nimport { showMessage } from \"../../../core/helpers\";\r\nimport { MAPPIGNS } from \"../../routes\";\r\n\r\nexport interface HomeProps {\r\n    site?: string;\r\n}\r\n\r\nexport interface HomeState {\r\n    list: Training[];\r\n}\r\n\r\nexport class Home extends React.Component<any, HomeState> {\r\n    list: Training[];\r\n    subscription: FlowTask<Training[]>\r\n    onDeleteSubscription: FlowTask<boolean>;\r\n    state: HomeState;\r\n    constructor(props: HomeProps) {\r\n        super(props);\r\n        this.state = {\r\n            list: []\r\n        }\r\n\r\n        this.updateList = this.updateList.bind(this);\r\n        this.onDeleteTrainingComplete = this.onDeleteTrainingComplete.bind(this);\r\n        this.deleteTraining = this.deleteTraining.bind(this);\r\n\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.subscription = window.$flow.subscribe(\"GET_ALL_TRAININGS\");\r\n        this.subscription.finish(this.updateList);\r\n        this.onDeleteSubscription = window.$flow.subscribe(\"DELETE_TRAINING\", { finish: this.onDeleteTrainingComplete })\r\n        window.$flow.perform(\"GET_ALL_TRAININGS\");\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        window.$flow.unsubscribe(\"GET_ALL_TRAININGS\", this.subscription.id);\r\n        window.$flow.unsubscribe(\"DELETE_TRAINING\", this.onDeleteSubscription.id);\r\n    }\r\n\r\n    deleteTraining(id: number) {\r\n        let list = [...this.state.list];\r\n        let elementIdx = list.findIndex(item => item.id === id);\r\n        if (elementIdx > -1) {\r\n            window.$cui.alert(\"delete-training-dialog\", \"YesNoCancel\", {\r\n                title: \"Delete training\",\r\n                message: \"Do you really want to delete training: \" + list[elementIdx].name + \"?\",\r\n                onYes: () => {\r\n                    window.$flow.perform(\"DELETE_TRAINING\", id)\r\n                }\r\n            })\r\n        } else {\r\n            showMessage(\"Delete training\", \"We cannot remove this training. Identified doesn't match.\")\r\n        }\r\n\r\n\r\n    }\r\n\r\n    onDeleteTrainingComplete(flag: boolean) {\r\n        if (flag) {\r\n            window.$flow.perform(\"GET_ALL_TRAININGS\");\r\n        } else {\r\n            showMessage(\"Delete training\", \"Service could not remove training\")\r\n        }\r\n    }\r\n\r\n    updateList(list: Training[]) {\r\n        this.setState({\r\n            ...this.state,\r\n            list: list\r\n        });\r\n    }\r\n\r\n\r\n\r\n    render() {\r\n        return <div className=\"stopwatch-page-layout\" >\r\n            <div className=\"stopwatch-page-top cui-container cui-center\">\r\n                <div>\r\n                    <span className=\"cui-icon stopwatch-icon\" cui-icon=\"stopwatch\"></span>\r\n                    <h1 className=\"cui-h3 cui-text-center cui-margin-small-top stopwatch-title\">Stopwatch</h1>\r\n                </div>\r\n            </div>\r\n            <div className=\"stopwatch-page-bottom\">\r\n                <div className=\"stopwatch-home-list cui-overflow-y-auto\">\r\n                    {this.state.list.length > 0 ? <TrainingList list={this.state.list} onDelete={this.deleteTraining} /> : <NoTrainings />}\r\n                </div>\r\n            </div>\r\n            <div className=\"cui-position-float cui-position-bottom cui-position-right cui-margin cui-margin-large--l z-index-100\">\r\n                <Link to={MAPPIGNS.renderUrl(\"newTraining\")} className=\"cui-button cui-icon cui-icon-margin cui-background-default cui-box-shadow cui-rounded\" cui-icon=\"plus\">Add New</Link>\r\n            </div>\r\n        </div>;\r\n    }\r\n}\r\n\r\nexport function NoTrainings() {\r\n    return <div className=\"cui-container cui-center\">\r\n        <p className=\"cui-text-muted cui-text-center\">There are no trainings recorded. <Link className=\"cui-link cui-accent\" to={MAPPIGNS.renderUrl(\"newTraining\")}>Add new</Link> training to start your execises!</p>\r\n    </div>;\r\n}\r\n","import * as React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nexport interface ErrorProps {\r\n}\r\n\r\n// 'HelloProps' describes the shape of props.\r\n// State is never set so we use the '{}' type.\r\nexport class ErrorRoute extends React.Component<ErrorProps, {}> {\r\n    constructor(props: ErrorProps) {\r\n        super(props);\r\n    }\r\n    render() {\r\n        return <div className=\"cui-section cui-flex-center cui-height-viewport-1-2\">\r\n            <div className=\"cui-card cui-large\">\r\n                <div className=\"cui-card-header cui-text-error\">\r\n                    <span className=\"cui-card-title\">Error</span>\r\n                </div>\r\n                <div className=\"cui-card-body\">\r\n                    It appears that page you looking for does not exist.\r\n                    Try to look for it again or go back to our Home page\r\n                </div>\r\n                <div className=\"cui-card-footer cui-flex cui-right\">\r\n                    <Link to=\"/\" className=\"cui-link\">Go Home</Link>\r\n                </div>\r\n            </div>\r\n        </div >\r\n    }\r\n}","import * as React from \"react\";\r\nimport { NavLink } from \"react-router-dom\";\r\n\r\nexport interface NavbarLinkProps {\r\n    url: string;\r\n    name: string;\r\n    shouldClose?: boolean;\r\n    class?: string;\r\n}\r\n\r\nexport class NavbarLink extends React.Component<NavbarLinkProps, {}> {\r\n    constructor(props: NavbarLinkProps) {\r\n        super(props);\r\n        this.onClick = this.onClick.bind(this);\r\n    }\r\n\r\n    onClick() {\r\n        if (this.props.shouldClose) {\r\n            let offcanvas = window.$cui.get(\"#app-offcanvas\");\r\n            offcanvas.emit('close');\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return <NavLink exact activeClassName=\"cui-active\" className={this.props.class} to={this.props.url} onClick={this.onClick}>{this.props.name}</NavLink>;\r\n    }\r\n}","import * as React from \"react\";\r\nimport { Link, useLocation } from \"react-router-dom\";\r\nimport { MAPPIGNS } from \"../../routes\";\r\nimport { NavbarLink } from \"../common/NavbarLink\";\r\n\r\nexport interface NavbarState {\r\n    currentSite: string;\r\n    darkMode: boolean;\r\n    soundEnabled: boolean\r\n}\r\n\r\nexport interface NavbarProps {\r\n    site?: string;\r\n    location?: any;\r\n}\r\n\r\nexport function Navbar(props: NavbarProps) {\r\n    const currentLocation = useLocation();\r\n    const [state, setState] = React.useState<NavbarState>({\r\n        currentSite: \"\",\r\n        darkMode: false,\r\n        soundEnabled: false\r\n    });\r\n\r\n    function onGetSound(flag: boolean): void {\r\n\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        let split = currentLocation.pathname.split('/');\r\n        setState({\r\n            ...state,\r\n            currentSite: split.length > 1 ? currentLocation.pathname.split('/')[1].toLocaleUpperCase() : \"\"\r\n        })\r\n    }, [currentLocation])\r\n    return <nav className={\"cui-navbar cui-sticky cui-box-shadow-remove stopwatch-layout-navigation\"}>\r\n        <div className=\"cui-navbar-left cui-width-1-1 cui-width-auto--m cui-flex cui-middle cui-between\" id=\"navbar-left\">\r\n            <ul>\r\n                {state.currentSite && <li><Link className=\"cui-icon\" to={MAPPIGNS.renderUrl(\"home\")} cui-icon=\"stopwatch_small\"></Link></li>}\r\n            </ul>\r\n            <a className=\"cui-icon cui-padding cui-button cui-hidden--m\" cui-icon=\"menu\" cui-open=\"target: #app-offcanvas\"></a>\r\n        </div>\r\n\r\n        <ul className=\"cui-navbar-right cui-visible--m\">\r\n            <li><NavbarLink class=\"cui-navbar-item\" url={MAPPIGNS.renderUrl(\"home\")} name={MAPPIGNS.getName(\"home\")} /></li>\r\n            <li><NavbarLink class=\"cui-navbar-item\" url={MAPPIGNS.renderUrl(\"actions\")} name={MAPPIGNS.getName(\"actions\")} /></li>\r\n            <li><NavbarLink class=\"cui-navbar-item\" url={MAPPIGNS.renderUrl(\"settings\")} name={MAPPIGNS.getName(\"settings\")} /></li>\r\n            <li><NavbarLink class=\"cui-navbar-item\" url={MAPPIGNS.renderUrl(\"about\")} name={MAPPIGNS.getName(\"about\")} /></li>\r\n        </ul>\r\n    </nav>\r\n}","import * as React from \"react\";\r\nimport { ElementManager } from \"../../../../node_modules/cui-light/dist/index\";\r\nimport { MAPPIGNS } from \"../../routes\";\r\nimport { NavbarLink } from \"../common/NavbarLink\";\r\n\r\nexport interface OffCanvasProps {\r\n}\r\n\r\n// 'HelloProps' describes the shape of props.\r\n// State is never set so we use the '{}' type.\r\nexport class OffCanvas extends React.Component<OffCanvasProps, {}> {\r\n    constructor(props: OffCanvasProps) {\r\n        super(props);\r\n    }\r\n\r\n    render() {\r\n        return <div className=\"cui-off-canvas\" id=\"app-offcanvas\" cui-off-canvas=\"escClose: y; outClose: y\">\r\n            <div className=\"cui-off-canvas-container cui-card off-canvas-layout\">\r\n                <div className=\"cui-card-header cui-flex cui-middle cui-right\">\r\n                    <a href=\"#\" className=\"cui-icon\" cui-icon=\"close\" cui-close=\"\"></a>\r\n                </div>\r\n                <div className=\"off-canvas-content cui-card-body\">\r\n\r\n                    <div className=\"cui-width-1-1\">\r\n                        <h3 className=\"cui-h3\">Menu</h3>\r\n                        <ul className=\"cui-list cui-interactive cui-margin-top\">\r\n                            <li><NavbarLink url={MAPPIGNS.renderUrl(\"home\")} name={MAPPIGNS.getName(\"home\")} shouldClose={true} /></li>\r\n                            <li><NavbarLink url={MAPPIGNS.renderUrl(\"actions\")} name={MAPPIGNS.getName(\"actions\")} shouldClose={true} /></li>\r\n                            <li><NavbarLink url={MAPPIGNS.renderUrl(\"settings\")} name={MAPPIGNS.getName(\"settings\")} shouldClose={true} /></li>\r\n                            <li><NavbarLink url={MAPPIGNS.renderUrl(\"about\")} name={MAPPIGNS.getName(\"about\")} shouldClose={true} /></li>\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    }\r\n}","export const StopwatchActionType = {\r\n    EXERCISE: 'exercise',\r\n    BREAK: 'break',\r\n    COOLDOWN: \"cooldown\",\r\n    WARMUP: \"warmup\"\r\n}\r\n\r\nexport interface Settings {\r\n    darkMode: boolean;\r\n    soundEnabled: boolean;\r\n    isWelcome: boolean;\r\n}\r\n\r\nexport interface StopwatchAction {\r\n    id: string;\r\n    name: string;\r\n    duration: string;\r\n    type?: string;\r\n    color?: string;\r\n    removable?: boolean;\r\n    editable?: boolean;\r\n}\r\n\r\nexport interface Round {\r\n    actions: StopwatchAction[];\r\n    break?: number;\r\n    name?: string;\r\n}\r\n\r\nexport interface Training {\r\n    name: string;\r\n    description?: string;\r\n    id?: string;\r\n    rounds: Round[];\r\n}\r\n\r\nexport class Exercise implements StopwatchAction {\r\n    id: string;\r\n    name: string;\r\n    duration: string;\r\n    type: string = StopwatchActionType.EXERCISE;\r\n    removable: false;\r\n    constructor(duration: number, name?: string) {\r\n        this.id = \"00001\";\r\n        this.duration = \"\" + duration;\r\n        this.name = name ? name : 'Exercise';\r\n    }\r\n}\r\n\r\nexport class WarmUp implements StopwatchAction {\r\n    id: string;\r\n    name: string;\r\n    duration: string;\r\n    type: string = StopwatchActionType.WARMUP;\r\n    removable: boolean = false;\r\n\r\n    constructor(duration: number) {\r\n        this.id = \"00002\";\r\n        this.duration = \"\" + duration;\r\n        this.name = \"Warm Up\"\r\n    }\r\n}\r\n\r\nexport class CoolDown implements StopwatchAction {\r\n    id: string;\r\n    name: string;\r\n    duration: string;\r\n    type: string = StopwatchActionType.COOLDOWN;\r\n    removable: false;\r\n    constructor(duration: number, name?: string) {\r\n        this.id = \"00003\";\r\n        this.duration = \"\" + duration;\r\n        this.name = name ? name : \"Cooldown\";\r\n    }\r\n}","import { StopwatchAction, StopwatchActionType } from \"./models\";\r\n\r\nexport const DefaultActions: StopwatchAction[] = [{\r\n    name: \"Warmup\",\r\n    duration: 5,\r\n    type: StopwatchActionType.WARMUP,\r\n    removable: false,\r\n    editable: false\r\n},\r\n{\r\n    name: \"Exercise\",\r\n    duration: 30,\r\n    type: StopwatchActionType.EXERCISE,\r\n    removable: false,\r\n    editable: false\r\n},\r\n{\r\n    name: \"Break\",\r\n    duration: 60,\r\n    type: StopwatchActionType.BREAK,\r\n    removable: false,\r\n    editable: false\r\n},\r\n{\r\n    name: \"Cooldown\",\r\n    duration: 90,\r\n    type: StopwatchActionType.WARMUP,\r\n    removable: false,\r\n    editable: false\r\n}]\r\n\r\nexport const ERROR_CODES = {\r\n    e0000: \"OK\",\r\n    e0100: \"Training is empty\",\r\n    e0101: \"Training name is not provided\",\r\n    e0102: \"Training has no rounds\",\r\n    e0200: \"Round is empty\",\r\n    e0201: \"Round has no actions\",\r\n    e0202: \"Round name is missing\",\r\n    e0300: \"Action is empty\",\r\n    e0301: \"Action name is not provided\",\r\n    e0302: \"Action type is not provided\",\r\n    e0303: \"Action duration is not correct\"\r\n\r\n}\r\n\r\nexport function getDefaultRoundName(index: number) {\r\n    return \"Round \" + index;\r\n}","import { IActionsService } from \"../../core/services/interfaces\"\r\nimport { StopwatchAction } from \"../../core/models\";\r\n\r\nexport const ACTIONS_FLOW_ACTIONS = {\r\n    GET_ALL: \"GET_ALL\",\r\n    SET_ACTION: \"SET_ACTION\",\r\n    REMOVE_ACTION: \"REMOVE_ACTION\",\r\n    CLEAR_ACTIONS: \"CLEAR_ACTIONS\"\r\n}\r\n\r\nexport type ActionsFlowInput = StopwatchAction;\r\nexport type ActionsFlowOutput = boolean | StopwatchAction[];\r\n\r\nexport class ActionsFlow {\r\n    #service: IActionsService;\r\n    constructor(service: IActionsService) {\r\n        this.#service = service;\r\n    }\r\n    getActions() {\r\n        return {\r\n            [ACTIONS_FLOW_ACTIONS.GET_ALL]: () => {\r\n                return this.#service.getAllActions();\r\n            },\r\n            [ACTIONS_FLOW_ACTIONS.SET_ACTION]: (action: StopwatchAction) => {\r\n                return this.#service.setAction(action);\r\n            },\r\n            [ACTIONS_FLOW_ACTIONS.REMOVE_ACTION]: (action: StopwatchAction) => {\r\n                return this.#service.removeAction(action);\r\n            },\r\n            [ACTIONS_FLOW_ACTIONS.CLEAR_ACTIONS]: () => {\r\n                this.#service.clearActions();\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n}","import * as React from 'react'\r\n\r\nexport interface BpdActionIconProps {\r\n    type: string;\r\n}\r\n\r\nexport function BpdActionIcon(props: BpdActionIconProps) {\r\n    return (\r\n        <span className=\"cui-icon cui-tooltip\" data-tooltip={props.type} cui-icon={`stopwatch_${props.type}`}></span>\r\n    );\r\n}\r\n","import { Round, StopwatchAction, Training } from \"./models\";\r\nimport { ERROR_CODES } from \"./statics\";\r\nimport { is } from '../../node_modules/bpd-toolkit/dist/esm/index';\r\n\r\nexport interface ValidationResult {\r\n    status: boolean;\r\n    errors?: string[];\r\n}\r\n\r\nexport interface IValidator<T> {\r\n    validate(t: T): ValidationResult\r\n}\r\n\r\nexport abstract class ValidatorBase<T> implements IValidator<T> {\r\n    validate(t: T): ValidationResult {\r\n        const result: ValidationResult = { status: true }\r\n        try {\r\n            let errors = this.performValidation(t);\r\n            if (errors && errors.length > 0) {\r\n                result.status = false;\r\n                result.errors = errors;\r\n            }\r\n        } catch (e) {\r\n            let errorMsg = \"An error occured during validation\";\r\n            console.error(errorMsg)\r\n            console.error(e)\r\n            result.status = false;\r\n            result.errors = [errorMsg + \": \" + e.message]\r\n        }\r\n        return result;\r\n    }\r\n\r\n    protected abstract performValidation(t: T): string[];\r\n}\r\n\r\nexport class TrainingValidator extends ValidatorBase<Training> {\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    protected performValidation(t: Training): string[] {\r\n        if (!is(t)) {\r\n            return ([ERROR_CODES.e0100]);\r\n        }\r\n        let errors = []\r\n        if (!is(t.name)) {\r\n            errors.push(ERROR_CODES.e0101)\r\n        }\r\n        if (!is(t.rounds)) {\r\n            errors.push(ERROR_CODES.e0102)\r\n        }\r\n        return errors;\r\n    }\r\n\r\n}\r\n\r\n\r\nexport class RoundValidator extends ValidatorBase<Round> {\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    protected performValidation(t: Round): string[] {\r\n        if (!is(t)) {\r\n            return ([ERROR_CODES.e0200]);\r\n        }\r\n        let errors = []\r\n        if (!is(t.name))\r\n            errors.push(ERROR_CODES.e0202);\r\n        if (!is(t.actions))\r\n            errors.push(ERROR_CODES.e0201)\r\n        return errors;\r\n    }\r\n}\r\n\r\nexport class ActionValidator extends ValidatorBase<StopwatchAction> {\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    protected performValidation(t: StopwatchAction): string[] {\r\n        if (!is(t)) {\r\n            return ([ERROR_CODES.e0300]);\r\n        }\r\n        let errors = []\r\n        if (!is(t.name)) {\r\n            errors.push(ERROR_CODES.e0301)\r\n        }\r\n        if (!is(t.type)) {\r\n            errors.push(ERROR_CODES.e0302)\r\n        }\r\n        if (t.duration < 0) {\r\n            errors.push(ERROR_CODES.e0303)\r\n        }\r\n        return errors;\r\n    }\r\n}","import * as React from 'react'\r\n\r\nexport interface BpdDialogProps {\r\n    title: string;\r\n    id: string;\r\n    body?: JSX.Element;\r\n    footer?: JSX.Element;\r\n    className?: string;\r\n}\r\n\r\nexport function BpdDialog(props: BpdDialogProps) {\r\n    React.useEffect(() => {\r\n    }, [props])\r\n    return (<div className={`cui-dialog ${props.className ?? \"\"}`} cui-dialog=\"escClose: Y\" id={props.id}>\r\n        <div className=\"cui-dialog-container\">\r\n            <div className=\"cui-dialog-header\">\r\n                <span className=\"cui-dialog-title\">{props.title}</span>\r\n                <a className=\"cui-icon\" cui-icon=\"close\" cui-close=\"\"></a>\r\n            </div>\r\n            <div className=\"cui-dialog-body\">\r\n                {props.body}\r\n            </div>\r\n\r\n            {props.footer && (<div className=\"cui-dialog-footer\">\r\n                {props.footer}\r\n            </div>)}\r\n\r\n        </div>\r\n    </div>)\r\n}\r\n","import * as React from 'react'\r\n\r\nexport interface ErrorsListProps {\r\n    errors: string[];\r\n}\r\n\r\n\r\nexport function ErrorsList(props: ErrorsListProps) {\r\n    return (\r\n        <>\r\n            {props.errors &&\r\n                props.errors.length > 0 &&\r\n                <ul className=\"cui-list\">\r\n                    {\r\n                        props.errors.map((error: string, index: number) => {\r\n                            return <li key={index} className=\"cui-animation-fade-in\"><span className=\"cui-text-error\">{error}</span></li>\r\n                        })\r\n                    }\r\n                </ul>}\r\n        </>\r\n    );\r\n}\r\n","import * as React from \"react\";\r\nimport { StopwatchAction, StopwatchActionType } from \"../../../core/models\";\r\nimport { ActionValidator } from \"../../../core/validators\";\r\nimport { BpdDialog } from \"../common/BpdDialog\";\r\nimport { ErrorsList } from \"../common/ErrorsList\";\r\n\r\nexport interface AddActionDialogProps {\r\n    action: StopwatchAction;\r\n    onSave: (action: StopwatchAction) => void;\r\n}\r\n\r\nexport function AddActionDialog(props: AddActionDialogProps) {\r\n    const [state, setState] = React.useState<StopwatchAction>({\r\n        name: \"\",\r\n        duration: 5,\r\n        removable: true,\r\n        editable: false,\r\n        type: StopwatchActionType.EXERCISE\r\n    })\r\n\r\n    const [errors, setErrors] = React.useState<string[]>([])\r\n\r\n    function onValueChange(event: any) {\r\n        let name = event.target.name;\r\n\r\n        switch (name) {\r\n            case \"name\":\r\n            case \"duration\":\r\n            case \"type\":\r\n                setState({ ...state, [name]: event.target.value })\r\n                break;\r\n            case \"removable\":\r\n            case \"editable\":\r\n                setState({ ...state, [name]: event.target.checked })\r\n                break;\r\n        }\r\n    }\r\n\r\n    function onSave() {\r\n        if (props.onSave) {\r\n            let action: StopwatchAction = { ...state };\r\n            let actionValidator = new ActionValidator().validate(action)\r\n            if (actionValidator.status) {\r\n                let dialogCui = window.$cui.get(\"#add-action-dialog\");\r\n                props.onSave(action);\r\n                dialogCui.emit('close');\r\n            }\r\n            setErrors(actionValidator.errors);\r\n        }\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        if (props.action) {\r\n            setState({\r\n                ...props.action\r\n            })\r\n            setErrors([]);\r\n        }\r\n        return () => {\r\n\r\n        }\r\n    }, [props.action])\r\n    return (<BpdDialog\r\n        title=\"Add new\"\r\n        id=\"add-action-dialog\"\r\n        body={<>\r\n            <div className=\"cui-form\">\r\n                <label className=\"cui-form-label\">Name</label>\r\n                <input className=\"cui-input stopwatch-input-width\" type=\"text\" name=\"name\" value={state.name} placeholder=\"Name\" onChange={onValueChange} />\r\n            </div>\r\n            <div className=\"cui-form cui-margin-top\">\r\n                <label className=\"cui-form-label\">Duration</label>\r\n                <input className=\"cui-input stopwatch-input-width\" type=\"number\" min=\"0\" max=\"100\" name=\"duration\" value={state.duration} placeholder=\"Duration\" onChange={onValueChange} />\r\n            </div>\r\n            <div className=\"cui-form cui-margin-top\">\r\n                <label className=\"cui-form-label\">Type</label>\r\n                <select className=\"cui-select stopwatch-input-width\" value={state.type} name=\"type\" onChange={onValueChange} >\r\n                    <option value=\"warmup\">Warmup</option>\r\n                    <option value=\"exercise\">Exercise</option>\r\n                    <option value=\"break\">Break</option>\r\n                    <option value=\"cooldown\">Cooldown</option>\r\n                </select>\r\n            </div>\r\n            <div className=\"cui-form cui-flex cui-middle cui-reverse cui-margin-top\">\r\n                <input type=\"checkbox\" className=\"cui-checkbox\" id=\"checkbox-1-2\" name=\"editable\" checked={state.editable} onChange={onValueChange} />\r\n                <label htmlFor=\"checkbox-1-2\"> Editable</label>\r\n            </div>\r\n            <div className=\"cui-form cui-flex cui-middle cui-reverse cui-margin-top\">\r\n                <input type=\"checkbox\" className=\"cui-checkbox\" id=\"checkbox-1-1\" name=\"removable\" checked={state.removable} onChange={onValueChange} />\r\n                <label htmlFor=\"checkbox-1-1\"> Removable</label>\r\n            </div>\r\n            <ErrorsList errors={errors} />\r\n        </>\r\n        }\r\n        footer={\r\n            <div className=\"cui-flex cui-right\">\r\n                <button className=\"cui-button cui-margin-small-right\" cui-close=\"\">Cancel</button>\r\n                <button className=\"cui-button cui-accent\" onClick={onSave}>Save</button>\r\n            </div>\r\n        }\r\n    />);\r\n}","import * as React from 'react'\r\n\r\nexport interface PageHeaderProps {\r\n    title: string;\r\n    description: string;\r\n}\r\n\r\n\r\nexport function PageHeader(props: PageHeaderProps) {\r\n    return (<div className=\"stopwatch-page-header cui-container cui-center\">\r\n        <div>\r\n            <h1 className=\"cui-h1 cui-text-center cui-margin-remove\">{props.title}</h1>\r\n            <p className=\"cui-text-center cui-text-muted\">{props.description}</p>\r\n        </div>\r\n    </div>);\r\n}\r\n","import * as React from 'react'\r\nimport { is } from '../../../../node_modules/bpd-toolkit/dist/esm/index';\r\n\r\nexport interface ClearableInputProps {\r\n    value: string;\r\n    onUpdate?: (value: string) => void;\r\n    className?: string;\r\n}\r\n\r\n\r\nexport function ClearableInput(props: ClearableInputProps) {\r\n    const [value, setValue] = React.useState<string>('');\r\n\r\n    function onInputChange(ev: any) {\r\n        changeValue(ev.target.value);\r\n    }\r\n\r\n    function changeValue(value: string) {\r\n        setValue(value);\r\n        if (is(props.onUpdate)) {\r\n            props.onUpdate(value);\r\n        }\r\n    }\r\n\r\n    return (<div className={\"cui-input-mix \" + props.className}>\r\n        <input type=\"text\" className=\"cui-input\" placeholder=\"Filter\" value={value} onChange={onInputChange} />\r\n        {is(value) && <a className=\"cui-icon\" cui-icon=\"close\" onClick={() => changeValue(\"\")}></a>}\r\n    </div>);\r\n}\r\n","import * as React from 'react'\r\nimport { StopwatchAction } from '../../../core/models';\r\nimport { DefaultActions } from '../../../core/statics';\r\nimport { ACTIONS_FLOW_ACTIONS } from '../../../app/flow/actions';\r\nimport { BpdActionIcon } from '../common/BpdActionIcon';\r\nimport { AddActionDialog } from './AddActionDialog';\r\nimport { PageHeader } from '../common/PageHeader';\r\nimport { deleteActionConfirmDialog } from '../common/Dialogs';\r\nimport { getBgClassByType } from '../../../core/helpers';\r\nimport { is } from '../../../../node_modules/bpd-toolkit/dist/esm/index';\r\nimport { ClearableInput } from '../common/ClearableInput';\r\n\r\nconst defaultAction: StopwatchAction = {\r\n    id: undefined,\r\n    name: \"\",\r\n    type: \"exercise\",\r\n    duration: \"5\",\r\n    removable: true,\r\n    editable: true\r\n}\r\n\r\nexport interface BpdDialogState {\r\n    action: StopwatchAction;\r\n}\r\n\r\nexport interface StopWatchActionsState {\r\n    actions: StopwatchAction[];\r\n    current: StopwatchAction;\r\n}\r\n\r\n\r\nexport function StopwatchActionsComponent() {\r\n    const [state, setState] = React.useState<StopWatchActionsState>({\r\n        actions: [...DefaultActions],\r\n        current: null\r\n    })\r\n\r\n    const [filter, setFilter] = React.useState<string>(\"\");\r\n\r\n    function onDialogSave(action: StopwatchAction) {\r\n        window.$actionsFlow.perform(ACTIONS_FLOW_ACTIONS.SET_ACTION, action);\r\n    }\r\n\r\n    function onDelete(action: StopwatchAction) {\r\n        deleteActionConfirmDialog(action.name, () => {\r\n            window.$actionsFlow.perform(ACTIONS_FLOW_ACTIONS.REMOVE_ACTION, action);\r\n        })\r\n    }\r\n\r\n    function onGetAll(actions: StopwatchAction[]) {\r\n        setState({\r\n            ...state,\r\n            actions: [...DefaultActions, ...actions]\r\n        })\r\n    }\r\n\r\n    function onAddOrEditClick(action?: StopwatchAction) {\r\n        setState({\r\n            ...state,\r\n            current: action || { ...defaultAction }\r\n        })\r\n        let dialogCui = window.$cui.get(\"#add-action-dialog\");\r\n        dialogCui.emit('open');\r\n    }\r\n\r\n    function updateFilter(value: string) {\r\n        setFilter(value);\r\n    }\r\n\r\n    function matchesName(name: string): boolean {\r\n        if (!is(filter)) {\r\n            return true;\r\n        }\r\n        let match = name.toLowerCase().match(filter.toLowerCase());\r\n        return is(match);\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        const getAllSub = window.$actionsFlow.subscribe(ACTIONS_FLOW_ACTIONS.GET_ALL, { finish: onGetAll })\r\n        const setActionSub = window.$actionsFlow.subscribe(ACTIONS_FLOW_ACTIONS.SET_ACTION)\r\n        const removeActionSub = window.$actionsFlow.subscribe(ACTIONS_FLOW_ACTIONS.REMOVE_ACTION)\r\n        window.$actionsFlow.perform(ACTIONS_FLOW_ACTIONS.GET_ALL);\r\n        return () => {\r\n            window.$actionsFlow.unsubscribe(ACTIONS_FLOW_ACTIONS.GET_ALL, getAllSub.id);\r\n            window.$actionsFlow.unsubscribe(ACTIONS_FLOW_ACTIONS.SET_ACTION, setActionSub.id);\r\n            window.$actionsFlow.unsubscribe(ACTIONS_FLOW_ACTIONS.REMOVE_ACTION, removeActionSub.id);\r\n        }\r\n    }, [state.actions])\r\n\r\n    return (<><div className=\"stopwatch-content-width\">\r\n        <PageHeader title=\"Activities\" description=\"Define activies which you want to perform in trainings!\" />\r\n        <div className=\"cui-container cui-flex cui-middle cui-middle cui-center cui-right--s\">\r\n            <ClearableInput value={filter} onUpdate={updateFilter} className=\"cui-width-1-1 cui-width-1-3--m cui-width-1-4--l\" />\r\n        </div>\r\n        <div className=\"cui-container cui-flex-grid cui-flex-grid-match cui-child-width-1-2 cui-child-width-1-3--m\">\r\n            {is(state.actions) && state.actions.map((action: StopwatchAction, index: number) => {\r\n                return (matchesName(action.name) &&\r\n                    <div key={index} className=\"cui-animation-fade-in\">\r\n                        <div className={\"cui-card cui-default cui-hover \" + getBgClassByType(action.type)} onClick={(ev) => { if (action.editable) { onAddOrEditClick(action); ev.preventDefault(); } }}>\r\n                            <div className=\"cui-card-header cui-flex cui-between cui-nowrap\">\r\n                                <span className=\"cui-card-title cui-text-truncate cui-overflow-hidden\">{action.name}</span>\r\n                                <BpdActionIcon type={action.type} />\r\n                            </div>\r\n                            <div className=\"cui-card-body cui-flex cui-middle action-card-height\">\r\n                                <div className=\"cui-flex-grow\">\r\n                                    <div className=\"cui-text-muted\"><span>{action.duration} seconds</span></div>\r\n                                </div>\r\n                                <div className=\"cui-flex-shrink\">\r\n                                    <ul className=\"cui-icon-nav\">\r\n                                        {action.removable && <li><a className=\"cui-icon\" cui-icon=\"trash\" onClick={() => { if (action.editable) { onDelete(action) } }}></a></li>}\r\n                                    </ul>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>)\r\n            })}\r\n        </div>\r\n        <div className=\"cui-position-float cui-position-bottom cui-position-right cui-margin cui-margin-large--l z-index-100\">\r\n            <button className=\"cui-icon cui-button cui-icon-margin cui-background-default cui-box-shadow cui-rounded\" cui-icon=\"plus\" onClick={() => { onAddOrEditClick() }}>Add New</button>\r\n        </div>\r\n    </div>\r\n        <AddActionDialog action={state.current} onSave={onDialogSave} /></>);\r\n}\r\n","export function onDeleteTrainingDialog(name: string, onConfirm: () => void) {\r\n    window.$cui.alert(\"delete-training-dialog\", \"YesNoCancel\", {\r\n        title: \"Delete training\",\r\n        message: \"Do you really want to delete training: \" + name + \"?\",\r\n        onYes: onConfirm\r\n    })\r\n}\r\n\r\nexport function deleteRoundConfirmDialog(onOnfirm: () => void) {\r\n    window.$cui.alert(\"delete-round-dialog\", \"YesNoCancel\", {\r\n        title: \"Delete round\",\r\n        message: \"Do you really want to delete this round?\",\r\n        onYes: onOnfirm\r\n    })\r\n}\r\n\r\nexport function deleteActionConfirmDialog(name: string, onConfirm: () => void) {\r\n    window.$cui.alert(\"delete-action-dialog\", \"YesNoCancel\", {\r\n        title: \"Delete action\",\r\n        message: \"Do you really want to delete action: \" + name,\r\n        onYes: onConfirm\r\n    })\r\n}","import * as React from 'react'\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nfunction GoBack(props: any) {\r\n    const { history } = props;\r\n    return (<button className=\"cui-button cui-accent\" onClick={() => history.goBack()}>Go Back</button>)\r\n}\r\n\r\n\r\nexport default withRouter(GoBack);","import * as React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport GoBack from \"./GoBack\";\r\n\r\nexport interface NotFoundProps {\r\n    message: string;\r\n    classes?: string;\r\n    goBack?: boolean;\r\n}\r\n\r\nexport function NotFound(props: NotFoundProps) {\r\n    return (<div className={props.classes}>\r\n        <h2 className=\"cui-h2 cui-text-center cui-text-error\">{props.message}</h2>\r\n        <div className=\"\">\r\n            <div className=\"cui-flex cui-center\">\r\n                <Link to=\"/\" className=\"cui-button cui-margin-small-right\">Go Home</Link>\r\n                {props.goBack ?? <GoBack />}\r\n            </div>\r\n        </div>\r\n\r\n    </div>);\r\n}","import * as React from 'react'\r\nimport { StopwatchAction } from '../../../core/models';\r\nexport interface ActionsSelectProps {\r\n    actions: StopwatchAction[];\r\n    id: string;\r\n    name: string;\r\n    className?: string;\r\n    value?: string;\r\n    onSelect: (action: StopwatchAction) => void;\r\n}\r\nexport function ActionsSelect(props: ActionsSelectProps) {\r\n    function onChange(ev: any) {\r\n        if (props.onSelect) {\r\n            let name = ev.target.value;\r\n            props.onSelect(props.actions.find(item => item.name === name))\r\n        }\r\n    }\r\n    return (\r\n        <select className={\"cui-select \" + props.className} name={props.name} id={props.id} onChange={onChange} value={props.value}>\r\n            {props.actions && props.actions.map((action: StopwatchAction) => {\r\n                return <option key={action.name} value={action.name}>{action.name} (Type: {action.type}, Duration: {action.duration})</option>\r\n            })}\r\n        </select>\r\n    );\r\n}\r\n","import * as React from \"react\";\r\nimport { useState } from \"react\";\r\nimport { is } from \"../../../../node_modules/bpd-toolkit/dist/esm/index\";\r\nimport { ACTIONS_FLOW_ACTIONS } from \"../../../app/flow/actions\";\r\nimport { Round, StopwatchAction } from \"../../../core/models\";\r\nimport { getDefaultRoundName } from \"../../../core/statics\";\r\nimport { RoundValidator } from \"../../../core/validators\";\r\nimport { ActionsSelect } from \"../actions/ActionsSelect\";\r\nimport { BpdActionIcon } from \"../common/BpdActionIcon\";\r\nimport { BpdDialog } from \"../common/BpdDialog\";\r\n\r\nexport interface EditRoundDialogProps {\r\n    onSave: (round: Round, index: number) => void;\r\n    definedActions: StopwatchAction[];\r\n    round: Round;\r\n    index: number;\r\n    currentCount: number;\r\n}\r\n\r\nexport interface EditRoundDialogState {\r\n    name: string;\r\n    actions?: StopwatchAction[];\r\n    selected: StopwatchAction;\r\n    errors: string[];\r\n}\r\n\r\nexport function EditRoundDialog(props: EditRoundDialogProps) {\r\n    const [state, setState] = useState<EditRoundDialogState>({\r\n        actions: [],\r\n        selected: null,\r\n        errors: [],\r\n        name: \"\"\r\n    })\r\n\r\n    function onSave() {\r\n        if (props.onSave) {\r\n            let round: Round = {\r\n                actions: [...state.actions],\r\n                name: state.name\r\n            }\r\n            let validation = new RoundValidator().validate(round);\r\n            if (validation.status) {\r\n                props.onSave(round, props.index);\r\n                setState({\r\n                    ...state,\r\n                    name: getDefaultRoundName(props.currentCount + 1),\r\n                    selected: null,\r\n                    actions: []\r\n                })\r\n                return;\r\n            }\r\n            setState({\r\n                ...state,\r\n                errors: validation.errors\r\n            })\r\n\r\n        }\r\n    }\r\n\r\n    function onActionSelectChange(action: StopwatchAction) {\r\n        if (action) {\r\n            setState({\r\n                ...state,\r\n                selected: action\r\n            })\r\n        }\r\n    }\r\n\r\n    function onAddAction() {\r\n        if (state.selected) {\r\n            setStateRoundData([...state.actions, state.selected])\r\n        }\r\n    }\r\n\r\n    function onDeleteAction(index: number) {\r\n        let newActions = [...state.actions];\r\n        newActions.splice(index, 1);\r\n        setStateRoundData(newActions)\r\n    }\r\n\r\n    function setStateRoundData(actions: StopwatchAction[], name?: string) {\r\n        setState({\r\n            actions: actions,\r\n            selected: props.definedActions[0],\r\n            errors: [],\r\n            name: name ? name : state.name\r\n        })\r\n    }\r\n\r\n    function roundNameUpdate(ev: any) {\r\n        let name = ev.target.value;\r\n        let errors = [];\r\n        if (!is(name)) {\r\n            errors.push(\"Name cannot be empty\")\r\n        }\r\n        setState({\r\n            ...state,\r\n            errors: errors,\r\n            name: name\r\n        })\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        let name = props.round && props.round.name ? props.round.name : getDefaultRoundName(props.currentCount);\r\n        let actions = is(props.round) ? props.round.actions : [];\r\n        setStateRoundData(actions, name);\r\n\r\n        return () => {\r\n        }\r\n    }, [props.round, props.definedActions, props.currentCount])\r\n    return (<BpdDialog\r\n        id=\"edit-round-dialog\"\r\n        title=\"Edit Round\"\r\n        body={<>\r\n            <div className=\"edit-round-dialog-body\">\r\n                <div className=\"cui-form\">\r\n                    <label htmlFor=\"\" className=\"cui-form-label\">Round name</label>\r\n                    <input type=\"text\" className=\"cui-input\" placeholder=\"Round name\" value={state.name} onChange={roundNameUpdate} />\r\n                </div>\r\n                <ul className=\"cui-list cui-margin-top\">\r\n                    <div>Actions</div>\r\n                    {state.actions && state.actions.map((item: StopwatchAction, index: number) => {\r\n                        return <li key={index} className=\"animation-fade-in\" >\r\n                            <div className=\"cui-flex cui-middle\">\r\n                                <div className=\"cui-flex-grow\">\r\n                                    <div className=\"cui-flex cui-middle\">\r\n                                        <div className=\"cui-flex-center cui-margin-right\">\r\n                                            <BpdActionIcon type={item.type} />\r\n                                        </div>\r\n                                        <div className=\"cui-flex-grow\">\r\n                                            <div className=\"\">{item.name}</div>\r\n                                            <div className=\"cui-text-muted\">Lasts {item.duration} seconds</div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                </div>\r\n                                <ul className=\"cui-icon-nav\">\r\n                                    <li><a className=\"cui-icon\" cui-icon=\"trash\" onClick={() => { onDeleteAction(index) }}></a></li>\r\n                                </ul>\r\n                            </div>\r\n                        </li>\r\n                    })}\r\n                    <li>\r\n                        <div className=\"cui-flex cui-middle cui-nowrap\">\r\n                            <div className=\"cui-flex-grow\">\r\n                                <ActionsSelect id=\"round-action-select\" className=\"cui-width-1-1 cui-width-5-6--s\" name=\"action\" value={state.selected?.name} actions={props.definedActions} onSelect={onActionSelectChange} />\r\n                            </div>\r\n                            <div className=\"\">\r\n                                <a cui-icon=\"plus\" className=\"cui-icon-button\" onClick={onAddAction}></a>\r\n                            </div>\r\n                        </div>\r\n                    </li>\r\n                </ul>\r\n                {state.errors && state.errors.length > 0 && <ul className=\"cui-list \">\r\n                    {state.errors.map((error: string, index: number) => {\r\n                        return <li key={index} className=\"cui-animation-slide-in\"><span className=\"cui-text-error\">{error}</span></li>\r\n                    })}\r\n                </ul>}\r\n            </div>\r\n        </>\r\n        }\r\n        footer={\r\n            <div className=\"cui-flex cui-right\" >\r\n                <button className=\"cui-button cui-margin-small-right\" cui-close=\"\">Cancel</button>\r\n                <button className=\"cui-button cui-accent\" onClick={onSave}>Save</button>\r\n            </div >\r\n        }\r\n    />)\r\n}","import * as React from 'react';\r\nimport { calculateDuration } from '../../../core/helpers';\r\nimport { Round } from \"../../../core/models\";\r\nimport { getDefaultRoundName } from '../../../core/statics';\r\n\r\ninterface RoundListItemProps {\r\n    round: Round;\r\n    index: number;\r\n    isFirst: boolean;\r\n    isLast: boolean;\r\n    onEdit: (round: Round, index: number) => void;\r\n    onDelete: (round: Round, index: number) => void;\r\n    onMoveDown: (round: Round, index: number) => void;\r\n    onMoveUp: (round: Round, index: number) => void;\r\n    onClone: (round: Round, index: number) => void;\r\n}\r\n\r\nexport function EditRoundListItem(props: RoundListItemProps) {\r\n\r\n    return (\r\n        <div className=\"cui-flex cui-middle cui-nowrap\">\r\n            <div className=\"cui-flex-grow\">\r\n                <div><span className=\"cui-text-bold\">{props.round.name}</span></div>\r\n                <div className=\"cui-text-muted cui-text-small cui-text-no-wrap\"><span >{props.round.actions.length} actions, {calculateDuration(props.round.actions)} seconds</span></div>\r\n\r\n            </div>\r\n\r\n            <ul className=\"cui-icon-nav cui-flex-shrink\">\r\n                {!props.isFirst && <li><a className=\"cui-icon\" cui-icon=\"chevron_up\" onClick={() => { props.onMoveUp(props.round, props.index) }} cui-tooltip=\"Move up\"></a></li>}\r\n                {!props.isLast && <li><a className=\"cui-icon\" cui-icon=\"chevron_down\" onClick={() => { props.onMoveDown(props.round, props.index) }} cui-tooltip=\"Move down\"></a></li>}\r\n                <li><a className=\"cui-icon\" cui-icon=\"copy\" onClick={() => { props.onClone(props.round, props.index) }} cui-tooltip=\"Clone\"></a></li>\r\n                <li><a className=\"cui-icon\" cui-icon=\"edit\" onClick={() => { props.onEdit(props.round, props.index) }} cui-tooltip=\"Edit\"></a></li>\r\n                <li><a className=\"cui-icon\" cui-icon=\"trash\" onClick={() => { props.onDelete(props.round, props.index) }} cui-tooltip=\"Delete\"></a></li>\r\n            </ul>\r\n        </div>\r\n    );\r\n}","import * as React from 'react'\r\nimport { Link, useParams, withRouter } from 'react-router-dom';\r\nimport { clone, is } from '../../../../node_modules/bpd-toolkit/dist/esm/index';\r\nimport { ACTIONS_FLOW_ACTIONS } from '../../../app/flow/actions';\r\nimport { insert, move, showMessage } from '../../../core/helpers';\r\nimport { Round, StopwatchAction, Training } from '../../../core/models';\r\nimport { DefaultActions } from '../../../core/statics';\r\nimport { TrainingValidator } from '../../../core/validators';\r\nimport { MAPPIGNS } from '../../routes';\r\nimport { deleteRoundConfirmDialog, onDeleteTrainingDialog } from '../common/Dialogs';\r\nimport { NotFound } from '../common/NotFound';\r\nimport { PageHeader } from '../common/PageHeader';\r\nimport { EditRoundDialog } from './EditRoundDialog';\r\nimport { EditRoundListItem } from './EditRoundListItem';\r\n\r\nexport interface EditTrainingSectionProps {\r\n    training: Training;\r\n    //   onSave: (training: Training) => void;\r\n    onUpdate: (training: Training) => void;\r\n    onCancel: () => void;\r\n}\r\n\r\n\r\nexport interface EditTrainingProps {\r\n    history: any;\r\n}\r\n\r\ninterface EditTrainingState {\r\n    training: Training;\r\n}\r\n\r\ninterface EditTrainingSectionState {\r\n    currentIndex: number;\r\n    currentRound: Round;\r\n    currentCount: number;\r\n}\r\n\r\ninterface EditTrainingDefinedActions {\r\n    actions: StopwatchAction[];\r\n}\r\n\r\nfunction EditTraining(props: EditTrainingProps) {\r\n    const [state, setState] = React.useState<EditTrainingState>({\r\n        training: {\r\n            name: \"\",\r\n            rounds: []\r\n        }\r\n    })\r\n\r\n    const { id } = useParams();\r\n\r\n\r\n    function getTraining() {\r\n        if (id) {\r\n            window.$flow.perform(\"GET_TRAINING\", id);\r\n        }\r\n    }\r\n\r\n    function onUpdate(training: Training) {\r\n        setState({\r\n            ...state,\r\n            training: training\r\n        }\r\n        )\r\n    }\r\n\r\n    function onUpdateTraining(result: boolean): void {\r\n        if (!result) {\r\n            showMessage(\"Fail\", \"Training was not saved\")\r\n        } else {\r\n            goBack();\r\n        }\r\n    }\r\n\r\n    function goBack() {\r\n        if (props.history) {\r\n            props.history.goBack();\r\n        }\r\n    }\r\n\r\n    function onGetTraining(training: Training): void {\r\n        if (training) {\r\n            setState({\r\n                training: { ...training }\r\n            })\r\n        } else {\r\n            showMessage(\"Fail\", \"Training was not found\")\r\n        }\r\n    }\r\n\r\n    function onTrainingSave(ev: any) {\r\n        let validaton = new TrainingValidator().validate(state.training);\r\n        if (validaton.status) {\r\n            window.$flow.perform(\"UPDATE_TRAINING\", state.training)\r\n        } else {\r\n            showMessage(\"Training not valid\", validaton.errors.join(\", \"))\r\n        }\r\n    }\r\n\r\n    function onDeleteTraining() {\r\n        onDeleteTrainingDialog(state.training.name, onYes)\r\n    }\r\n\r\n    function onYes() {\r\n        window.$flow.perform(\"DELETE_TRAINING\", state.training.id)\r\n    }\r\n\r\n    function onDeleteTrainingSub(result: boolean) {\r\n        goBack();\r\n    }\r\n\r\n\r\n    React.useEffect(() => {\r\n        console.log(\"Parent redraw\")\r\n        const updateTrainingSub = window.$flow.subscribe(\"UPDATE_TRAINING\", { finish: onUpdateTraining })\r\n        const getTrainingSub = window.$flow.subscribe(\"GET_TRAINING\", { finish: onGetTraining })\r\n        const deleteTraininSub = window.$flow.subscribe(\"DELETE_TRAINING\", {\r\n            finish: onDeleteTrainingSub\r\n        })\r\n        getTraining();\r\n\r\n        return () => {\r\n            window.$flow.unsubscribe(\"UPDATE_TRAINING\", updateTrainingSub.id);\r\n            window.$flow.unsubscribe(\"GET_TRAINING\", getTrainingSub.id);\r\n            window.$flow.unsubscribe(\"DELETE_TRAINING\", deleteTraininSub.id);\r\n        }\r\n    }, [state.training.id])\r\n\r\n    return (<>\r\n        <div className=\"edit-container\">\r\n            <div className=\"edit-container-content cui-overflow-y-auto\">\r\n                <div className=\"cui-container stopwatch-content-width\">\r\n                    <PageHeader title={is(state.training?.name) ? \"Update training \" + state.training.name : \"Define training\"} description=\"Customize your training settings\" />\r\n                </div>\r\n                <div className=\"\">\r\n                    {state.training ?\r\n                        <EditTrainingSection training={state.training} onUpdate={onUpdate} onCancel={goBack} /> :\r\n                        <NotFound message=\"The training you looking for could not be found\" classes=\"\" />}\r\n                </div>\r\n            </div>\r\n            <div className=\"edit-container-bottom\">\r\n                <div className=\"cui-container stopwatch-content-width cui-flex cui-middle cui-center cui-right--m\">\r\n                    <ul className=\"cui-list cui-inline\">\r\n                        <li className=\"cui-padding-remove\"><a className=\"cui-icon cui-icon-margin cui-margin-right\" cui-icon=\"close\" onClick={() => { goBack() }}>Cancel</a></li>\r\n                        <li className=\"cui-padding-remove\"><Link to={MAPPIGNS.renderUrl('perform', { id: state.training.id })} className=\"cui-icon cui-accent cui-icon-margin cui-margin-right\" cui-icon=\"media_play\">Run</Link></li>\r\n                        <li className=\"cui-padding-remove\"><a className=\"cui-icon cui-error cui-icon-margin cui-margin-right\" cui-icon=\"trash\" onClick={() => { onDeleteTraining() }}>Delete</a></li>\r\n                        <li className=\"cui-padding-remove\"><a className=\"cui-icon cui-success cui-icon-margin\" cui-icon=\"checkmark\" onClick={onTrainingSave}>Save</a></li>\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </>);\r\n}\r\n\r\n\r\nfunction EditTrainingSection(props: EditTrainingSectionProps) {\r\n    const [state, setState] = React.useState<EditTrainingSectionState>({\r\n        currentIndex: -1,\r\n        currentCount: 0,\r\n        currentRound: null\r\n    })\r\n\r\n    const [definedActions, setDefinedActions] = React.useState<EditTrainingDefinedActions>({\r\n        actions: []\r\n    })\r\n\r\n\r\n    function onRoundEdit(round: Round, index: number) {\r\n        setState({\r\n            ...state,\r\n            currentIndex: index,\r\n            currentRound: round,\r\n            currentCount: props.training && props.training.rounds ? props.training.rounds.length : 0\r\n        })\r\n        window.$cui.get(\"#edit-round-dialog\").emit(\"open\")\r\n    }\r\n\r\n    function onRoundDelete(round: Round, index: number) {\r\n        deleteRoundConfirmDialog(() => {\r\n            let rounds = [<div className=\"props\"></div>.training.rounds]\r\n            rounds.splice(index, 1)\r\n            updateRoundsState(rounds)\r\n        })\r\n    }\r\n\r\n    function onRoundDown(round: Round, index: number) {\r\n        updateRoundsState(move(props.training.rounds, index, index + 1))\r\n    }\r\n\r\n\r\n    function onRoundUp(round: Round, index: number) {\r\n        updateRoundsState(move(props.training.rounds, index, index - 1))\r\n    }\r\n\r\n    function onRoundClone(round: Round, index: number) {\r\n        let idx = index + 1;\r\n        let cloned = clone(round);\r\n        updateRoundsState(insert(props.training.rounds, idx, cloned))\r\n    }\r\n\r\n    function onRoundSave(round: Round, index: number) {\r\n        updateRoundsState(updateOrInsertRound(round, index));\r\n        window.$cui.get(\"#edit-round-dialog\").emit(\"close\");\r\n    }\r\n\r\n    function updateOrInsertRound(round: Round, index: number) {\r\n        let rounds = []\r\n        if (index > -1) {\r\n            rounds = [...props.training.rounds];\r\n            rounds[index] = round;\r\n        } else {\r\n            rounds = [...props.training.rounds, round];\r\n        }\r\n        return rounds;\r\n    }\r\n\r\n    function updateRoundsState(rounds: Round[]) {\r\n        props.onUpdate(\r\n            {\r\n                ...props.training,\r\n                rounds: rounds\r\n            }\r\n        )\r\n    }\r\n\r\n    function onFormChange(ev: any) {\r\n        let name = ev.target.name;\r\n        if (['name', 'description'].includes(name)) {\r\n            props.onUpdate({\r\n                ...props.training,\r\n                [name]: ev.target.value\r\n            })\r\n        }\r\n    }\r\n\r\n    function getDefinedActions(actions: StopwatchAction[]) {\r\n        setDefinedActions({\r\n            actions: [...DefaultActions, ...actions]\r\n        })\r\n    }\r\n\r\n    React.useEffect(() => {\r\n\r\n        const getDefinedActionsSub = window.$actionsFlow.subscribe(ACTIONS_FLOW_ACTIONS.GET_ALL, { finish: getDefinedActions });\r\n        window.$actionsFlow.perform(ACTIONS_FLOW_ACTIONS.GET_ALL);\r\n        setState({\r\n            ...state\r\n        })\r\n        return () => {\r\n            window.$actionsFlow.unsubscribe(ACTIONS_FLOW_ACTIONS.GET_ALL, getDefinedActionsSub.id)\r\n\r\n        }\r\n    }, [props.training])\r\n\r\n    return (<>\r\n        <div className=\"cui-container stopwatch-content-width cui-flex-grid cui-child-width-1-1 cui-child-width-1-2--m\">\r\n            <div className=\"cui-padding-small-right\">\r\n                <h3 className=\"cui-h3 cui-text-muted\">Common</h3>\r\n                <div className=\"cui-form\">\r\n                    <label htmlFor=\"\" className=\"cui-form-label\">Name</label>\r\n                    <input type=\"text\" className=\"cui-input stopwatch-input-width\" placeholder=\"Name\" name=\"name\" value={props.training.name} onChange={onFormChange} />\r\n                </div>\r\n                <div className=\"cui-form cui-margin-top\">\r\n                    <label htmlFor=\"\" className=\"cui-form-label\">Description</label>\r\n                    <textarea className=\"cui-textarea stopwatch-input-width stopwatch-text-area\" placeholder=\"Description\" name=\"description\" rows={5} value={props.training.description} onChange={onFormChange}></textarea>\r\n                </div>\r\n            </div>\r\n            <div className=\"cui-padding-small-left\">\r\n                <h3 className=\"cui-h3 cui-text-muted\">Rounds (total count: {props.training.rounds.length})</h3>\r\n                <ul className=\"cui-list\">\r\n                    {props.training && props.training.rounds.map((round: Round, index: number, arr: Round[]) => {\r\n                        return <li key={index} className=\"animation-fade-in\"><EditRoundListItem\r\n                            index={index}\r\n                            round={round}\r\n                            onEdit={onRoundEdit}\r\n                            onDelete={onRoundDelete}\r\n                            onMoveUp={onRoundUp}\r\n                            onMoveDown={onRoundDown}\r\n                            onClone={onRoundClone}\r\n                            isFirst={index === 0}\r\n                            isLast={index === arr.length - 1} />\r\n                        </li>\r\n                    })}\r\n                    <li>\r\n                        <button className=\"cui-button cui-icon cui-icon-margin cui-width-1-1\" cui-icon=\"plus\" onClick={() => {\r\n                            onRoundEdit(null, -1);\r\n                        }}>Add New</button>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n        </div>\r\n        <EditRoundDialog index={state.currentIndex} round={state.currentRound} onSave={onRoundSave} currentCount={state.currentCount} definedActions={definedActions.actions} />\r\n    </>);\r\n}\r\n\r\nexport default withRouter(EditTraining);","interface KeepScreenToggle {\r\n    activate(): void;\r\n    release(): void;\r\n}\r\n\r\nexport class KeepAwakeToggle implements KeepScreenToggle {\r\n    #screen: any;\r\n    constructor() {\r\n        this.#screen = screen;\r\n    }\r\n\r\n    activate() {\r\n        this.#screen.keepAwake = true;\r\n    }\r\n\r\n    release(): void {\r\n        this.#screen.keepAwake = false;\r\n    }\r\n\r\n}\r\n\r\nexport class WakeLockScreen implements KeepScreenToggle {\r\n    wakeLockRequest: any;\r\n\r\n    activate() {\r\n        let nav = navigator as any;\r\n        nav.wakeLock.request('screen').then((wakelock: any) => {\r\n            this.wakeLockRequest = wakelock;\r\n            console.log(\"Wakelock activated\");\r\n        })\r\n    }\r\n\r\n    release() {\r\n        if (this.wakeLockRequest) {\r\n            this.wakeLockRequest.release();\r\n            this.wakeLockRequest = null;\r\n            console.log(\"Wakelock deactivated\");\r\n        }\r\n    }\r\n}\r\n\r\nexport class LoopLockScreen implements KeepScreenToggle {\r\n    element: Element | undefined;\r\n\r\n    constructor() {\r\n        this.element = undefined;\r\n    }\r\n\r\n    activate(): void {\r\n        if (this.element) {\r\n            return;\r\n        }\r\n        this.element = this.createElement(\"/static/video/Screen.mp4\");\r\n        document.body.appendChild(this.element);\r\n    }\r\n\r\n    release(): void {\r\n        if (!this.element) {\r\n            return;\r\n        }\r\n        this.element.remove();\r\n        this.element = undefined;\r\n    }\r\n\r\n    private createElement(src: string): Element {\r\n        let newEl = document.createElement(\"video\");\r\n        newEl.autoplay = true;\r\n        newEl.muted = true;\r\n        newEl.loop = true;\r\n        newEl.src = src;\r\n        newEl.classList.add('loop-screen')\r\n        newEl.textContent = \"Not Supported\";\r\n        return newEl;\r\n    }\r\n\r\n}\r\n\r\nexport class KeepScreenAwakeFeature {\r\n    #toggle: KeepScreenToggle;\r\n\r\n    constructor() {\r\n        this.#toggle = this.getToggle();\r\n    }\r\n    activate() {\r\n        this.#toggle.activate();\r\n    }\r\n    release() {\r\n        this.#toggle.release();\r\n    }\r\n    private getToggle() {\r\n        if ('keepAwake' in screen) {\r\n            return new KeepAwakeToggle();\r\n        } else {\r\n            return new LoopLockScreen();\r\n            //return new WakeLockScreen();\r\n        }\r\n    }\r\n}","export const StopWatchStateOptions: any = {\r\n    RUNNING: \"RUNNING\",\r\n    STOPPED: \"STOPPED\",\r\n    PAUSED: \"PAUSED\",\r\n}\r\n\r\nexport type StopWatchState = \"RUNNING\" | 'PAUSED' | \"STOPPED\";\r\n\r\nexport interface StopwatchCallback {\r\n    (current: number, total: number, stopWatch: StopWatch): boolean;\r\n}\r\n\r\nexport interface IStopWatch {\r\n    start(): boolean;\r\n    stop(): boolean;\r\n    pause(): boolean;\r\n    resume(): boolean;\r\n    finish(): void;\r\n    getState(): StopWatchState;\r\n}\r\n\r\nexport class StopWatch implements IStopWatch {\r\n    #callback: StopwatchCallback;\r\n    #current: number;\r\n    #total: number;\r\n    #isReset: boolean;\r\n    #state: StopWatchState;\r\n    #id: any;\r\n    constructor() {\r\n        this.#current = 0;\r\n        this.#total = 0;\r\n        this.#isReset = false;\r\n        this.#state = StopWatchStateOptions.STOPPED;\r\n        this.#id = undefined;\r\n    }\r\n\r\n    onTick(callback: StopwatchCallback) {\r\n        this.#callback = callback;\r\n    }\r\n\r\n    tick() {\r\n        this.#id = setTimeout(() => {\r\n            try {\r\n                if (this.#state === StopWatchStateOptions.RUNNING && this.#callback(this.#current, this.#total, this)) {\r\n                    if (this.#isReset) {\r\n                        this.#current = 0;\r\n                        this.#isReset = false;\r\n                    } else {\r\n                        this.#current += 1;\r\n                        this.#total += 1;\r\n                    }\r\n                    this.tick();\r\n                } else if (this.#state !== StopWatchStateOptions.PAUSED) {\r\n                    this.stop();\r\n                }\r\n            } catch (e) {\r\n                console.error(\"An error occured on stopwatch tick\")\r\n                console.error(e)\r\n                this.stop();\r\n            }\r\n        }, 1000)\r\n    }\r\n\r\n    reset() {\r\n        this.#isReset = true;\r\n    }\r\n\r\n    start(): boolean {\r\n        if (this.#state === StopWatchStateOptions.RUNNING) {\r\n            return false;\r\n        }\r\n        this.#current = 0;\r\n        this.#state = StopWatchStateOptions.RUNNING;\r\n        this.tick();\r\n        return true;\r\n    }\r\n\r\n    stop(): boolean {\r\n        if (this.#state === StopWatchStateOptions.RUNNING) {\r\n            this.finish();\r\n            this.#state = StopWatchStateOptions.STOPPED;\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    pause(): boolean {\r\n        if (this.#state === StopWatchStateOptions.RUNNING) {\r\n            this.#state = StopWatchStateOptions.PAUSED;\r\n            return true\r\n        }\r\n        return false;\r\n    }\r\n\r\n    resume() {\r\n        if (this.#state === StopWatchStateOptions.PAUSED) {\r\n            this.#state = StopWatchStateOptions.RUNNING;\r\n            this.tick();\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    finish(): void {\r\n        if (this.#id) {\r\n            clearTimeout(this.#id);\r\n            this.#id = undefined;\r\n        }\r\n        this.#current = 0;\r\n        this.#total = 0;\r\n    }\r\n    getState() {\r\n        return this.#state;\r\n    }\r\n}","import { Settings } from \"../../core/models\";\r\nimport { ISettingsService } from \"../../core/services/interfaces\";\r\n\r\n\r\nexport const SETTINGS_FLOW_ACTIONS = {\r\n    GET_DARK_MODE: \"GET_DARK_MODE\",\r\n    SET_DARK_MODE: \"SET_DARK_MODE\",\r\n    GET_SOUND_ENABLED: \"GET_SOUND_ENABLED\",\r\n    SET_SOUND_ENABLED: \"SET_SOUND_ENABLED\",\r\n    SET_SETTINGS: \"SET_SETTINGS\",\r\n    GET_SETTINGS: \"GET_SETTINGS\",\r\n    GET_IS_WELCOME: \"GET_IS_WELCOME\",\r\n    SET_IS_WELCOME: \"SET_IS_WELCOME\",\r\n    CLEAR_SETTINGS: \"CLEAR_SETTINGS\"\r\n}\r\n\r\nexport type SettingsFlowInput = Settings | boolean;\r\nexport type SettingsFlowOutput = boolean | void | Settings;\r\n\r\nexport class SettingsFlow {\r\n    #service: ISettingsService;\r\n    constructor(service: ISettingsService) {\r\n        this.#service = service;\r\n    }\r\n    getActions() {\r\n        return {\r\n            [SETTINGS_FLOW_ACTIONS.GET_SOUND_ENABLED]: () => {\r\n                return this.#service.isSoundEnabled();\r\n            },\r\n            [SETTINGS_FLOW_ACTIONS.SET_SOUND_ENABLED]: (flag: boolean) => {\r\n                this.#service.setSoundEnabled(flag);\r\n            },\r\n            [SETTINGS_FLOW_ACTIONS.GET_DARK_MODE]: () => {\r\n                return this.#service.isDarkMode();\r\n            },\r\n            [SETTINGS_FLOW_ACTIONS.SET_DARK_MODE]: (flag: boolean) => {\r\n                this.#service.setDarkMode(flag);\r\n            },\r\n            [SETTINGS_FLOW_ACTIONS.SET_SETTINGS]: (value: Settings) => {\r\n                this.#service.setSettings(value);\r\n            },\r\n            [SETTINGS_FLOW_ACTIONS.GET_SETTINGS]: () => {\r\n                return this.#service.getSettings();\r\n            },\r\n            [SETTINGS_FLOW_ACTIONS.GET_IS_WELCOME]: () => {\r\n                return this.#service.isWelcomeSet();\r\n            },\r\n            [SETTINGS_FLOW_ACTIONS.SET_IS_WELCOME]: (flag: boolean) => {\r\n                this.#service.setIsWelcome(flag);\r\n            },\r\n            [SETTINGS_FLOW_ACTIONS.CLEAR_SETTINGS]: () => {\r\n                this.#service.clearSettings();\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n}","import * as React from 'react'\r\nimport { StopwatchState } from './PerformTraining';\r\n\r\nexport interface CountDownTimerProps {\r\n    watchState: StopwatchState;\r\n    actionIdx: number;\r\n}\r\n\r\nexport function CountDownTimer(props: CountDownTimerProps) {\r\n    return (<span className=\"cui-svg total-circle-progress\" cui-circle-progress={props.watchState.trainingProgress}>\r\n        <div className=\"\">\r\n            <span className=\"cui-svg current-circle-progress\" cui-circle-progress={props.watchState.roundProgress}>\r\n                <div>\r\n                    <span className=\"cui-svg countdown-circle-progress\" cui-circle-progress={props.watchState.progress}>\r\n                        <div>\r\n                            <span className=\"cui-block cui-text-small\">{props.actionIdx + 1}</span>\r\n                            <h1 className={\"cui-h1 cui-margin-remove \" + props.watchState.timerCls}>{props.watchState.timer}</h1>\r\n                        </div>\r\n                    </span>\r\n                </div>\r\n            </span>\r\n        </div>\r\n    </span>);\r\n}\r\n","import * as React from 'react'\r\nimport { useParams } from 'react-router-dom';\r\nimport { is } from '../../../../node_modules/bpd-toolkit/dist/esm/index';\r\nimport { KeepScreenAwakeFeature } from '../../../api/screen/screen';\r\nimport { StopWatch, StopWatchState, StopWatchStateOptions } from '../../../api/stopwatch/stopwatch';\r\nimport { SETTINGS_FLOW_ACTIONS } from '../../../app/flow/settings';\r\nimport { calcDisplayTimer, calculateDuration, calculateProgress, getBgClassByType, getTotalDuration, showMessage, getClassByType } from '../../../core/helpers';\r\nimport { Round, StopwatchAction, Training } from '../../../core/models';\r\nimport { ActionValidator, RoundValidator, TrainingValidator } from '../../../core/validators';\r\nimport { NotFound } from '../common/NotFound'; import { CountDownTimer } from './CountDownTimer';\r\n;\r\n\r\ninterface TimeStateData {\r\n    time: number;\r\n    progress: number;\r\n    ct?: number;\r\n    total: number;\r\n}\r\n\r\ninterface PerfromTrainingState {\r\n    training: Training;\r\n}\r\n\r\nexport interface CurrentTrainingState {\r\n    round: Round;\r\n    roundIdx: number;\r\n    action: StopwatchAction;\r\n    actionIdx: number;\r\n    class: string;\r\n    roundDuration: number;\r\n    totalDuration: number;\r\n}\r\n\r\nexport interface StopwatchState {\r\n    timer: string;\r\n    state: StopWatchState;\r\n    startBtnCls: string;\r\n    timerCls: string;\r\n    progress: number;\r\n    roundProgress: number;\r\n    trainingProgress: number;\r\n}\r\n\r\nconst defaultCurrent: CurrentTrainingState = {\r\n    round: undefined,\r\n    roundIdx: -1,\r\n    actionIdx: -1,\r\n    action: undefined,\r\n    class: \"\",\r\n    roundDuration: 0,\r\n    totalDuration: 0\r\n}\r\n\r\nexport function PerfromTraining() {\r\n    const [state, setState] = React.useState<PerfromTrainingState>({\r\n        training: undefined\r\n    })\r\n\r\n    const [stopwatch, setStopwatch] = React.useState<StopWatch>(undefined)\r\n    const [current, setCurrent] = React.useState<CurrentTrainingState>(defaultCurrent)\r\n    const [canPlay, setCanPlay] = React.useState<boolean>(false);\r\n\r\n    const [watchState, setWatchState] = React.useState<StopwatchState>({\r\n        timer: \"00:00\",\r\n        state: StopWatchStateOptions.STOPPED,\r\n        startBtnCls: getStartBtnCls(StopWatchStateOptions.STOPPED),\r\n        timerCls: \"\",\r\n        progress: 100,\r\n        roundProgress: 100,\r\n        trainingProgress: 100,\r\n    })\r\n\r\n    const [errorMessage, setErrorMessage] = React.useState(\"\");\r\n    const { id } = useParams();\r\n\r\n    const currentRef = React.useRef(current);\r\n    currentRef.current = current;\r\n    const trainingRef = React.useRef(state.training);\r\n    trainingRef.current = state.training;\r\n\r\n    const countdownSound = React.useRef(null);\r\n    const endSound = React.useRef(null);\r\n\r\n    function onGetTraining(training: Training) {\r\n        let validation = new TrainingValidator().validate(training);\r\n        if (!validation.status) {\r\n            showMessage(\"Incorrect training\", `Training is not correct: ${validation.errors.join(\", \")}`)\r\n            return;\r\n        }\r\n        let roundValidator = new RoundValidator().validate(training.rounds[0]);\r\n        if (!roundValidator.status) {\r\n            showMessage(\"Incorrect training\", `Training is not correct: ${roundValidator.errors.join(\", \")}`)\r\n            return;\r\n        }\r\n        let actionValidator = new ActionValidator().validate(training.rounds[0].actions[0]);\r\n        if (!actionValidator.status) {\r\n            showMessage(\"Incorrect training\", `Training is not correct: ${actionValidator.errors.join(\", \")}`)\r\n            return;\r\n        }\r\n        setState({\r\n            ...state,\r\n            training: training\r\n        })\r\n        setDefaultCurrentState(training);\r\n    }\r\n\r\n\r\n    function setDefaultCurrentState(training: Training) {\r\n        let round = training.rounds[0];\r\n        let action = round.actions[0];\r\n        setCurrent({\r\n            roundIdx: 0,\r\n            round: round,\r\n            action: action,\r\n            actionIdx: 0,\r\n            class: getClassByType(action.type),\r\n            roundDuration: calculateDuration(round.actions),\r\n            totalDuration: getTotalDuration(training)[1]\r\n        })\r\n    }\r\n\r\n    function setNextAction(): boolean {\r\n        let nextActionIdx = currentRef.current.actionIdx + 1;\r\n        if (currentRef.current.round.actions.length > nextActionIdx) {\r\n            let newAction = currentRef.current.round.actions[nextActionIdx]\r\n            setCurrent({\r\n                ...currentRef.current,\r\n                actionIdx: nextActionIdx,\r\n                action: newAction,\r\n                class: getClassByType(newAction.type)\r\n            })\r\n            return true;\r\n        }\r\n        let nextRoundIdx = currentRef.current.roundIdx + 1;\r\n        if (trainingRef.current.rounds.length > nextRoundIdx) {\r\n            let newRound = trainingRef.current.rounds[nextRoundIdx];\r\n            let newAction = newRound.actions[0];\r\n            setCurrent({\r\n                ...currentRef.current,\r\n                round: newRound,\r\n                roundIdx: nextRoundIdx,\r\n                actionIdx: 0,\r\n                action: newAction,\r\n                class: getClassByType(newAction.type),\r\n                roundDuration: calculateDuration(newRound.actions),\r\n            })\r\n            return true;\r\n        }\r\n        setDefaultCurrentState(trainingRef.current);\r\n        return false;\r\n    }\r\n\r\n    function onStopwatchTick(currentTime: number, total: number, stopwatch: StopWatch): boolean {\r\n        let ct = currentRef.current.action.duration - currentTime;\r\n        let progress = calculateProgress(currentTime, currentRef.current.action.duration)\r\n        if (ct > 0) {\r\n            // Normal ticl\r\n            setStopWatchState(stopwatch.getState(), {\r\n                time: ct,\r\n                progress: 100 - progress,\r\n                ct: currentTime,\r\n                total: total\r\n            })\r\n            // Start round end countdown\r\n            if (ct > 0 && ct <= 3) {\r\n                play(\"countdown\");\r\n            }\r\n            return true;\r\n        } else {\r\n            play(\"end\");\r\n            stopwatch.reset();\r\n            if (!setNextAction()) {\r\n\r\n                setStopWatchState(StopWatchStateOptions.STOPPED, {\r\n                    time: 0, progress: 100, ct: 0, total: 0\r\n                })\r\n                return false;\r\n            }\r\n            //setStopWatchState(StopWatchStateOptions.RUNNING, { time: 0, progress: 100, ct: currentTime, total: total })\r\n            return true;\r\n        }\r\n    }\r\n\r\n    function onStartClick() {\r\n        if (watchState.state === StopWatchStateOptions.STOPPED && stopwatch.start()) {\r\n            setStopWatchState(StopWatchStateOptions.RUNNING);\r\n        } else if (watchState.state !== StopWatchStateOptions.STOPPED && stopwatch.stop()) {\r\n            setDefaultCurrentState(state.training);\r\n            setStopWatchState(StopWatchStateOptions.STOPPED, { time: 0, progress: 100, ct: 0, total: 0 });\r\n\r\n        }\r\n    }\r\n\r\n    function onPauseClick() {\r\n        if (watchState.state === StopWatchStateOptions.RUNNING && stopwatch.pause()) {\r\n            setStopWatchState(StopWatchStateOptions.PAUSED);\r\n        } else if (watchState.state === StopWatchStateOptions.PAUSED && stopwatch && stopwatch.resume()) {\r\n            setStopWatchState(StopWatchStateOptions.RUNNING);\r\n        }\r\n    }\r\n\r\n    function setStopWatchState(watchstate: StopWatchState, timeData?: TimeStateData) {\r\n        if (!is(timeData) || timeData.time < 0) {\r\n            setWatchState({\r\n                ...watchState,\r\n                state: watchstate,\r\n                startBtnCls: getStartBtnCls(watchstate)\r\n            })\r\n        } else {\r\n            let roundProgress = calculateRoundProgress(timeData.ct);\r\n            let trainginProgress = calculateTrainingProgress(timeData.total);\r\n            setWatchState({\r\n                timer: calcDisplayTimer(timeData.time),\r\n                timerCls: getTimerCls(timeData.time),\r\n                state: watchstate,\r\n                startBtnCls: getStartBtnCls(watchstate),\r\n                progress: timeData.progress,\r\n                roundProgress: roundProgress,\r\n                trainingProgress: trainginProgress\r\n            })\r\n        }\r\n    }\r\n\r\n    function calculateRoundCurrentTime(ct: number) {\r\n        return currentRef.current.round.actions.reduce<number>((result: number, act: StopwatchAction, idx: number) => {\r\n            if (idx < currentRef.current.actionIdx) {\r\n                return result + act.duration;\r\n            }\r\n            return result;\r\n        }, 0) + ct;\r\n    }\r\n\r\n    function calculateRoundProgress(ct: number) {\r\n        return 100 - calculateProgress(calculateRoundCurrentTime(ct), currentRef.current.roundDuration);\r\n    }\r\n\r\n    function calculateTrainingProgress(ct: number) {\r\n        return 100 - calculateProgress(ct, currentRef.current.totalDuration);\r\n    }\r\n\r\n    function play(type: string) {\r\n        let element = undefined;\r\n        switch (type) {\r\n            case \"countdown\":\r\n                element = countdownSound.current;\r\n                break;\r\n            case \"end\":\r\n                element = endSound.current;\r\n                break;\r\n        }\r\n        if (element) {\r\n            element.currentTime = 0;\r\n            element.play();\r\n        }\r\n    }\r\n\r\n    function getTimerCls(timer: number): string {\r\n        return timer > 0 && timer <= 3 ? \"cui-text-warning timer-blink-animation\" : \"\";\r\n    }\r\n\r\n    function getStartBtnCls(state: StopWatchState) {\r\n        return state !== StopWatchStateOptions.STOPPED ? \"cui-error\" : \"cui-accent\";\r\n    }\r\n\r\n    function onGetPlaySound(canPlay: boolean) {\r\n        setCanPlay(canPlay);\r\n    }\r\n\r\n    function getBackgroundClass(action: StopwatchAction) {\r\n        return !is(action) ? \"\" : getBgClassByType(action.type);\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        const getTrainingSubscription = window.$flow.subscribe(\"GET_TRAINING\", { finish: onGetTraining })\r\n        const settingsPlaySound = window.$settingsFlow.subscribe(SETTINGS_FLOW_ACTIONS.GET_SOUND_ENABLED, {\r\n            finish: onGetPlaySound\r\n        })\r\n        window.$settingsFlow.perform(SETTINGS_FLOW_ACTIONS.GET_SOUND_ENABLED);\r\n        const wakeLock = new KeepScreenAwakeFeature();\r\n        try {\r\n            wakeLock.activate();\r\n        } catch (e) {\r\n            setErrorMessage(\"We could not activate feature to keep your device's screen awake during training performance\")\r\n        }\r\n        let stop = new StopWatch();\r\n        stop.onTick(onStopwatchTick);\r\n        setStopwatch(stop);\r\n        if (id > -1) {\r\n            window.$flow.perform(\"GET_TRAINING\", id)\r\n\r\n        }\r\n        return () => {\r\n            window.$flow.unsubscribe(\"GET_TRAINING\", getTrainingSubscription.id)\r\n            window.$settingsFlow.unsubscribe(SETTINGS_FLOW_ACTIONS.GET_SOUND_ENABLED, settingsPlaySound.id);\r\n            if (stopwatch)\r\n                stopwatch.stop();\r\n            wakeLock.release();\r\n        }\r\n    }, [id, canPlay])\r\n    return (<>\r\n        {!state.training ?\r\n            <NotFound message=\"We couldn't find training\" /> :\r\n            <div className={\"stopwatch-layout-content cui-flex-center \" + getBackgroundClass(current.action)}>\r\n                <div className=\"stopwatch-content-width perform-layout cui-text-center animation-fade-in\">\r\n                    <div className=\"perform-main-controls\">\r\n                        <h2 className=\"cui-h2 cui-margin-remove\">{state.training.name}</h2>\r\n                        <p className=\"cui-margin-remove\">{state?.training?.rounds[current.roundIdx]?.name}</p>\r\n                        <p className=\"cui-text-muted cui-text-small cui-margin-remove\">Round {current.roundIdx + 1} of {state.training.rounds.length}</p>\r\n                        <CountDownTimer actionIdx={current.actionIdx} watchState={watchState} />\r\n                    </div>\r\n                    <div className=\"perform-buttons\">\r\n                        <div className=\"cui-width-1-1\">\r\n                            <h3 className={\"cui-h3 \" + current.class}>{current.action && current.action.name}</h3>\r\n                            <div className=\"cui-flex cui-center\">\r\n                                {watchState.state !== StopWatchStateOptions.STOPPED && <button className=\"cui-button cui-default cui-margin-small-right\" onClick={onPauseClick}>{watchState.state === StopWatchStateOptions.PAUSED ? \"Resume\" : \"Pause\"}</button>}\r\n                                <button className={\"cui-button \" + watchState.startBtnCls} onClick={onStartClick}>{watchState.state === StopWatchStateOptions.STOPPED ? \"Start\" : \"Stop\"}</button>\r\n                            </div>\r\n                            <p className=\"cui-text-muted\">{state.training.description}</p>\r\n                            <div className=\"\">\r\n                                {is(errorMessage) && <span className=\"cui-icon cui-error cui-tooltip\" cui-icon=\"ban\" data-tooltip={errorMessage}></span>}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <audio ref={countdownSound} id=\"stopwatch-countdown\" src=\"/static/audio/stopwatch_countdown.mp3\" />\r\n                <audio ref={endSound} id=\"stopwatch-end\" src=\"/static/audio/stopwatch_end.mp3\" />\r\n            </div>\r\n        }\r\n    </>);\r\n}\r\n","import { Training } from \"../../core/models\";\r\nimport { ITrainingsService } from \"../../core/services/interfaces\";\r\n\r\nexport const ACTIONS = {\r\n    GET_ALL_TRAININGS: \"GET_ALL_TRAININGS\",\r\n    ADD_TRAINING: \"ADD_TRAINING\",\r\n    UPDATE_TRAINING: \"UPDATE_TRAINING\",\r\n    DELETE_TRAINING: \"DELETE_TRAINING\",\r\n    GET_TRAINING: \"GET_TRAINING\",\r\n    CLEAR_TRAININGS: \"CLEAR_TRAININGS\"\r\n\r\n}\r\n\r\nexport type TrainingsFlowInput = void | Training | number;\r\nexport type TrainingsFlowOutput = Training[] | Training | boolean;\r\n\r\nexport class TrainingsFlow {\r\n    #service: ITrainingsService;\r\n    constructor(service: ITrainingsService) {\r\n        this.#service = service;\r\n    }\r\n\r\n    getActions() {\r\n        return {\r\n            [ACTIONS.GET_ALL_TRAININGS]: () => {\r\n                return this.#service.getAllTrainings();\r\n            },\r\n            [ACTIONS.ADD_TRAINING]: (t: Training) => {\r\n                return this.#service.addTraining(t);\r\n            },\r\n            [ACTIONS.UPDATE_TRAINING]: (t: Training) => {\r\n                return this.#service.updateTraining(t);\r\n            },\r\n            [ACTIONS.DELETE_TRAINING]: (id: number) => {\r\n                return this.#service.deleteTraining(id);\r\n            },\r\n            [ACTIONS.GET_TRAINING]: (id: number) => {\r\n                return this.#service.getTraining(id);\r\n            },\r\n            [ACTIONS.CLEAR_TRAININGS]: () => {\r\n                this.#service.clearTrainings();\r\n                return true;\r\n            },\r\n        }\r\n    }\r\n}","import * as React from 'react'\r\nimport { ACTIONS_FLOW_ACTIONS } from '../../../app/flow/actions';\r\nimport { SETTINGS_FLOW_ACTIONS } from '../../../app/flow/settings';\r\nimport { ACTIONS } from '../../../app/flow/trainings';\r\n\r\nexport function SettingsDevTools() {\r\n    function onClear() {\r\n        window.$cui.toast(\"Data cleared\")\r\n    }\r\n\r\n    function onSettingsUpdate() {\r\n        console.log(\"Settings cleared\")\r\n        window.$settingsFlow.perform(SETTINGS_FLOW_ACTIONS.GET_SETTINGS);\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        const settingsClearSub = window.$settingsFlow.subscribe(SETTINGS_FLOW_ACTIONS.CLEAR_SETTINGS, { finish: onSettingsUpdate });\r\n        const actionsClearSub = window.$actionsFlow.subscribe(ACTIONS_FLOW_ACTIONS.CLEAR_ACTIONS, { finish: onClear });\r\n        const trainingsClearSub = window.$flow.subscribe(ACTIONS.CLEAR_TRAININGS, { finish: onClear });\r\n\r\n\r\n        return () => {\r\n\r\n            window.$settingsFlow.unsubscribe(SETTINGS_FLOW_ACTIONS.CLEAR_SETTINGS, settingsClearSub.id);\r\n            window.$actionsFlow.unsubscribe(ACTIONS_FLOW_ACTIONS.CLEAR_ACTIONS, actionsClearSub.id);\r\n            window.$flow.unsubscribe(ACTIONS.CLEAR_TRAININGS, trainingsClearSub.id);\r\n        }\r\n    }, [])\r\n    return (<div className=\"cui-section\">\r\n        <h3 className=\"cui-h3\">Dev tools</h3>\r\n        <div className=\"cui-flex\">\r\n            <button className=\"cui-button cui-margin-small cui-default\" onClick={() => { window.$actionsFlow.perform(ACTIONS_FLOW_ACTIONS.CLEAR_ACTIONS) }}>Clear actions only</button>\r\n            <button className=\"cui-button cui-margin-small cui-default\" onClick={() => { window.$flow.perform(ACTIONS.CLEAR_TRAININGS) }}>Clear trainings only</button>\r\n            <button className=\"cui-button cui-margin-small cui-default\" onClick={() => { window.$settingsFlow.perform(SETTINGS_FLOW_ACTIONS.CLEAR_SETTINGS) }}>Clear settings only</button>\r\n            <button className=\"cui-button cui-margin-small cui-error\" onClick={() => {\r\n                window.$actionsFlow.perform(ACTIONS_FLOW_ACTIONS.CLEAR_ACTIONS)\r\n                window.$flow.perform(ACTIONS.CLEAR_TRAININGS)\r\n                window.$settingsFlow.perform(SETTINGS_FLOW_ACTIONS.CLEAR_SETTINGS)\r\n            }}>Clear data</button>\r\n        </div>\r\n    </div>);\r\n}\r\n","import * as React from 'react'\r\nexport interface OnSwitchValueUpdate {\r\n    (name: string, value: boolean): void;\r\n}\r\n\r\n\r\nexport interface SettingsSwitchListItemProps {\r\n    label: string,\r\n    value: boolean,\r\n    name: string,\r\n    onUpdate: OnSwitchValueUpdate;\r\n}\r\n\r\nexport function SettingsSwitchListItem(props: SettingsSwitchListItemProps) {\r\n    function onChange(ev: any) {\r\n        let target = ev.target\r\n        if (props.onUpdate) {\r\n            props.onUpdate(target.name, target.checked);\r\n        }\r\n    }\r\n\r\n    React.useEffect(() => {\r\n\r\n    }, [props.value, props.name])\r\n    return (\r\n        <div className=\"cui-flex cui-middle cui-padding-small\">\r\n            <div className=\"cui-flex-grow\">{props.label}</div>\r\n            <div className=\"cui-input-switch\">\r\n                <input type=\"checkbox\" id={props.name} name={props.name} checked={props.value} onChange={onChange} />\r\n                <label htmlFor={props.name} className=\"cui-content\"></label>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\n","import * as React from 'react'\r\nimport { ACTIONS_FLOW_ACTIONS } from '../../../app/flow/actions';\r\nimport { SETTINGS_FLOW_ACTIONS } from '../../../app/flow/settings';\r\nimport { ACTIONS } from '../../../app/flow/trainings';\r\nimport { setDarkMode } from '../../../core/helpers';\r\nimport { Settings } from '../../../core/models';\r\nimport { PageHeader } from '../common/PageHeader';\r\nimport { SettingsDevTools } from './SettingsDevTools';\r\nimport { SettingsSwitchListItem } from './SettingsSwitchListItem'\r\nexport interface SettingsState {\r\n    darkModeEnabled: boolean;\r\n    soundEnabled: boolean;\r\n}\r\nexport function StopwatchSettings() {\r\n    const [settings, setSettings] = React.useState<Settings>({\r\n        soundEnabled: false,\r\n        darkMode: false,\r\n        isWelcome: false\r\n    })\r\n\r\n    function onValueChange(name: string, value: boolean) {\r\n        if (name !== 'soundEnabled' && name !== \"darkMode\") {\r\n            return;\r\n        }\r\n        let newSettings = {\r\n            ...settings,\r\n            [name]: value\r\n        }\r\n        window.$settingsFlow.perform(SETTINGS_FLOW_ACTIONS.SET_SETTINGS, newSettings);\r\n        setSettings(newSettings)\r\n    }\r\n\r\n    function onUpdateSettings() {\r\n        window.$settingsFlow.perform(SETTINGS_FLOW_ACTIONS.GET_SETTINGS);\r\n    }\r\n\r\n    function onGetSettings(settings: Settings) {\r\n        if (settings) {\r\n            console.log(settings)\r\n            setSettings(settings);\r\n            setDarkMode(settings.darkMode);\r\n        }\r\n    }\r\n\r\n\r\n\r\n    React.useEffect(() => {\r\n        console.log(\"Reload\")\r\n        const settingsSub = window.$settingsFlow.subscribe(SETTINGS_FLOW_ACTIONS.GET_SETTINGS, { finish: onGetSettings })\r\n        const settingsUpdateSub = window.$settingsFlow.subscribe(SETTINGS_FLOW_ACTIONS.SET_SETTINGS, { finish: onUpdateSettings })\r\n\r\n        onUpdateSettings();\r\n        return () => {\r\n            window.$settingsFlow.unsubscribe(SETTINGS_FLOW_ACTIONS.GET_SETTINGS, settingsSub.id);\r\n            window.$settingsFlow.unsubscribe(SETTINGS_FLOW_ACTIONS.SET_SETTINGS, settingsUpdateSub.id);\r\n\r\n        }\r\n    }, [settings.darkMode, settings.soundEnabled])\r\n    return (<><div className=\"stopwatch-content-width\">\r\n        <PageHeader title=\"Settings\" description=\"Change application setup\" />\r\n        <div className=\"cui-section\">\r\n            <ul className=\"cui-list\">\r\n                <li>\r\n                    <SettingsSwitchListItem label=\"Dark mode\" name=\"darkMode\" value={settings.darkMode} onUpdate={onValueChange} />\r\n                </li>\r\n                <li>\r\n                    <SettingsSwitchListItem label=\"Play sound\" name=\"soundEnabled\" value={settings.soundEnabled} onUpdate={onValueChange} />\r\n                </li>\r\n                <li>Welcome screen status: {settings.isWelcome ? \"Yes\" : \"No\"}</li>\r\n            </ul>\r\n        </div>\r\n        <SettingsDevTools />\r\n    </div></>);\r\n}\r\n\r\n\r\n","import * as React from 'react'\r\nimport { PageHeader } from '../common/PageHeader';\r\n\r\nexport function About() {\r\n    return (<><div className=\"stopwatch-content-width\">\r\n        <PageHeader title=\"About\" description=\"Some details about the application\" />\r\n        <div className=\"\">\r\n            <div className=\"cui-container \">\r\n                <h3 className=\"cui-h3\">Repository</h3>\r\n                <p className=\"\">Project sources can be found on Github under following link: <a className=\"cui-link cui-accent\" href=\"https://github.com/bpd-d/bpd-stopwatch-app\">bpd-stopwatch-app</a></p>\r\n            </div>\r\n            <div className=\"cui-container\">\r\n                <h3 className=\"cui-h3\">Links</h3>\r\n                <p className=\"\">Project uses third party libraries, see following list: </p>\r\n                <ul className=\"cui-list\">\r\n                    <li>\r\n                        <div className=\"\">\r\n                            <div className=\"\">\r\n                                <span>React</span>\r\n                            </div>\r\n                            <a href=\"https://github.com/facebook/react\" className=\"cui-link\">Github</a>\r\n                            <a href=\"https://reactjs.org/\" className=\"cui-link cui-margin-left\">React JS home page</a>\r\n                        </div>\r\n                    </li>\r\n                    <li>\r\n                        <div className=\"\">\r\n                            <div className=\"\">\r\n                                <span>cUI Light</span>\r\n                            </div>\r\n                            <a href=\"https://github.com/bpd-d/cui-light\" className=\"cui-link\">cUI Light on Github</a>\r\n                            <a href=\"https://github.com/bpd-d/cui-styles\" className=\"cui-link cui-margin-left\">cUI Styles on Github</a>\r\n                            <a href=\"https://github.com/bpd-d/cui-icons\" className=\"cui-link cui-margin-left\">cUI Icons on Github</a>\r\n                        </div></li>\r\n                    <li>\r\n                        <div className=\"\">\r\n                            <div className=\"\">\r\n                                <span>BPD Flow</span>\r\n                            </div>\r\n                            <a href=\"https://github.com/bpd-d/bpd-flow\" className=\"cui-link\">Github</a>\r\n                        </div>\r\n\r\n                    </li>\r\n                    <li>\r\n                        <div className=\"\">\r\n                            <div className=\"\">\r\n                                <span>BPD Storage</span>\r\n                            </div>\r\n                            <a href=\"https://github.com/bpd-d/bpd-storage\" className=\"cui-link\">Github</a>\r\n                        </div>\r\n\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n        </div>\r\n    </div></>);\r\n}\r\n","import * as React from 'react'\r\n\r\nexport function Footer() {\r\n    function currentYear(): string {\r\n        return new Date().getFullYear() + \"\";\r\n    }\r\n    return (\r\n        <div className=\"stopwatch-footer cui-flex cui-right--l cui-middle\">\r\n            <div className=\"cui-margin-horizontal\">\r\n                <span className=\"cui-margin-small-right\">Copyrights {currentYear()}</span>\r\n                <a href=\"https://github.com/bpd-d\" target=\"_blank\" className=\"cui-link cui-accent\">BPDDev</a>\r\n            </div>\r\n        </div>);\r\n}\r\n","import * as React from \"react\";\r\nimport * as ReactDOM from \"react-dom\";\r\nimport { Switch, Route, BrowserRouter, useLocation } from \"react-router-dom\";\r\nimport { Home } from \"./components/home/home\";\r\nimport { ErrorRoute } from \"./error\";\r\nimport { Navbar } from \"./components/navbar/navbar\";\r\nimport { OffCanvas } from \"./components/offacanvas/offcanvas\";\r\nimport { StopwatchActionsComponent } from \"./components/actions/StopwatchActionsComponent\";\r\nimport EditTraining from \"./components/trainings/EditTraining\";\r\nimport { PerfromTraining } from \"./components/perform/PerformTraining\";\r\nimport { StopwatchSettings } from \"./components/settings/StopwatchSettings\";\r\nimport { FlowTask } from \"../../node_modules/bpd-flow/dist/index\";\r\nimport { SETTINGS_FLOW_ACTIONS } from \"../app/flow/settings\";\r\nimport { setDarkMode } from \"../core/helpers\";\r\nimport { About } from \"./components/about/About\";\r\nimport { Footer } from \"./components/footer/Footer\";\r\nimport { MAPPIGNS } from \"./routes\";\r\nimport { ElementManager } from \"cui-light/dist/esm/managers/element\";\r\nimport { is } from \"bpd-toolkit/dist/esm/index\";\r\nimport { BpdDialog } from \"./components/common/BpdDialog\";\r\nimport { sleep } from \"node_modules/bpd-toolkit/dist/esm/index\";\r\n\r\nexport interface AppProps {\r\n}\r\nexport interface AppState {\r\n    currentSite?: string;\r\n}\r\n\r\n// 'HelloProps' describes the shape of props.\r\n// State is never set so we use the '{}' type.\r\nexport class App extends React.Component<AppProps, AppState> {\r\n    darkModeSub: FlowTask<any>;\r\n    welcomeScreenGetSub: FlowTask<any>;\r\n    welcomeDialogHandle: ElementManager;\r\n    welcomeDialogCloseEventIds: string[];\r\n    constructor(props: AppProps) {\r\n        super(props);\r\n        this.state = {\r\n            currentSite: \"\"\r\n        }\r\n        this.darkModeSub = window.$settingsFlow.subscribe(SETTINGS_FLOW_ACTIONS.GET_DARK_MODE, { finish: this.onDarkMode.bind(this) });\r\n        this.welcomeScreenGetSub = window.$settingsFlow.subscribe(SETTINGS_FLOW_ACTIONS.GET_IS_WELCOME, { finish: this.onWelcomeScreen.bind(this) });\r\n        this.welcomeDialogHandle = window.$cui.get(\"#welcome-dialog\");\r\n        this.welcomeDialogCloseEventIds = this.welcomeDialogHandle.on(\"close\", this.onWelcomeDialogClose.bind(this));\r\n        window.$settingsFlow.perform(SETTINGS_FLOW_ACTIONS.GET_IS_WELCOME);\r\n        window.$settingsFlow.perform(SETTINGS_FLOW_ACTIONS.GET_DARK_MODE);\r\n    }\r\n\r\n    componentDidUpdate() {\r\n\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        if (this.darkModeSub) {\r\n            window.$settingsFlow.unsubscribe(SETTINGS_FLOW_ACTIONS.GET_DARK_MODE, this.darkModeSub.id);\r\n        }\r\n        if (this.welcomeScreenGetSub) {\r\n            window.$settingsFlow.unsubscribe(SETTINGS_FLOW_ACTIONS.GET_IS_WELCOME, this.welcomeScreenGetSub.id);\r\n        }\r\n        if (is(this.welcomeDialogCloseEventIds)) {\r\n            this.welcomeDialogCloseEventIds.forEach(id => {\r\n                this.welcomeDialogHandle.detach(\"close\", id);\r\n            })\r\n        }\r\n    }\r\n\r\n    onDarkMode(flag: boolean) {\r\n        setDarkMode(flag);\r\n    }\r\n\r\n    onWelcomeScreen(flag: boolean) {\r\n        if (!flag) {\r\n            setTimeout(() => {\r\n                this.welcomeDialogHandle = window.$cui.get(\"#welcome-dialog\");\r\n                this.welcomeDialogCloseEventIds = this.welcomeDialogHandle.on(\"close\", this.onWelcomeDialogClose.bind(this));\r\n                window.$cui.get(\"#welcome-dialog\").emit(\"open\");\r\n            }, 100)\r\n\r\n        }\r\n    }\r\n\r\n    onWelcomeDialogClose() {\r\n        \r\n        window.$settingsFlow.perform(SETTINGS_FLOW_ACTIONS.SET_IS_WELCOME, true);\r\n    }\r\n\r\n\r\n\r\n    render() {\r\n        return <BrowserRouter>\r\n            <div className=\"stopwatch-layout-main\">\r\n                <Navbar />\r\n                <div className=\"stopwatch-layout-content cui-overflow-y-auto\">\r\n                    <Switch>\r\n                        <Route path={MAPPIGNS.getUrl(\"perform\")} component={PerfromTraining}></Route>\r\n                        <Route path={MAPPIGNS.getUrl(\"newTraining\")} component={EditTraining}></Route>\r\n                        <Route path={MAPPIGNS.getUrl(\"editTraining\")} component={EditTraining}></Route>\r\n                        <Route path={MAPPIGNS.getUrl(\"actions\")} component={StopwatchActionsComponent}></Route>\r\n                        <Route path={MAPPIGNS.getUrl(\"settings\")} component={StopwatchSettings}></Route>\r\n                        <Route path={MAPPIGNS.getUrl(\"about\")} component={About}></Route>\r\n                        <Route path={MAPPIGNS.getUrl(\"home\")} component={Home}></Route>\r\n                        <Route>\r\n                            <ErrorRoute />\r\n                        </Route>\r\n                    </Switch>\r\n                </div>\r\n                <Footer />\r\n\r\n                <OffCanvas />\r\n                <BpdDialog id=\"welcome-dialog\" title=\"Welcome\" />\r\n            </div></BrowserRouter >;\r\n    }\r\n}","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n};\r\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n};\r\nvar _elements, _isLocked, _logger, _cDt, _utils, _actionsHelper;\r\nimport { is, are } from \"cui-light-core/dist/esm/utils/functions\";\r\nimport { CuiLoggerFactory } from \"cui-light-core/dist/esm/factories/logger\";\r\nimport { CLASSES } from \"cui-light-core/dist/esm/utils/statics\";\r\nimport { CuiActionsHelper } from \"cui-light-core/dist/esm/helpers/helpers\";\r\nimport { CuiClassAction } from \"cui-light-core/dist/esm/utils/actions\";\r\nexport class ElementManager {\r\n    constructor(elements, utils) {\r\n        _elements.set(this, void 0);\r\n        _isLocked.set(this, void 0);\r\n        _logger.set(this, void 0);\r\n        _cDt.set(this, void 0);\r\n        _utils.set(this, void 0);\r\n        _actionsHelper.set(this, void 0);\r\n        __classPrivateFieldSet(this, _elements, elements);\r\n        __classPrivateFieldSet(this, _isLocked, false);\r\n        __classPrivateFieldSet(this, _logger, CuiLoggerFactory.get(\"ElementManager\"));\r\n        __classPrivateFieldSet(this, _utils, utils);\r\n        __classPrivateFieldSet(this, _cDt, Date.now());\r\n        __classPrivateFieldSet(this, _actionsHelper, new CuiActionsHelper(utils.interactions));\r\n    }\r\n    toggleClass(className) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!is(className)) {\r\n                return false;\r\n            }\r\n            return this.call((element) => {\r\n                if (!element.classList.contains(className)) {\r\n                    element.classList.add(className);\r\n                }\r\n                else {\r\n                    element.classList.remove(className);\r\n                }\r\n            }, 'toggleClass');\r\n        });\r\n    }\r\n    toggleClassAs(className) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!is(className)) {\r\n                return false;\r\n            }\r\n            return this.call((element) => {\r\n                let classes = element.classList;\r\n                __classPrivateFieldGet(this, _utils).interactions.fetch(() => {\r\n                    if (!classes.contains(className)) {\r\n                        __classPrivateFieldGet(this, _utils).interactions.mutate(classes.add, classes, className);\r\n                    }\r\n                    else {\r\n                        __classPrivateFieldGet(this, _utils).interactions.mutate(classes.remove, classes, className);\r\n                    }\r\n                }, this);\r\n            }, 'toggleClassAs');\r\n        });\r\n    }\r\n    setClass(className) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!is(className)) {\r\n                return false;\r\n            }\r\n            return this.call((element) => {\r\n                if (!element.classList.contains(className)) {\r\n                    element.classList.add(className);\r\n                }\r\n            }, 'setClass');\r\n        });\r\n    }\r\n    setClassAs(className) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!is(className)) {\r\n                return false;\r\n            }\r\n            return this.call((element) => {\r\n                let classes = element.classList;\r\n                __classPrivateFieldGet(this, _utils).interactions.fetch(() => {\r\n                    if (!classes.contains(className)) {\r\n                        __classPrivateFieldGet(this, _utils).interactions.mutate(classes.add, classes, className);\r\n                    }\r\n                }, this);\r\n            }, 'setClassAs');\r\n        });\r\n    }\r\n    removeClass(className) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!is(className)) {\r\n                return false;\r\n            }\r\n            return this.call((element) => {\r\n                if (element.classList.contains(className)) {\r\n                    element.classList.remove(className);\r\n                }\r\n            }, 'removeClass');\r\n        });\r\n    }\r\n    removeClassAs(className) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!is(className)) {\r\n                return false;\r\n            }\r\n            return this.call((element) => {\r\n                let classes = element.classList;\r\n                __classPrivateFieldGet(this, _utils).interactions.fetch(() => {\r\n                    if (classes.contains(className)) {\r\n                        __classPrivateFieldGet(this, _utils).interactions.mutate(classes.remove, classes, className);\r\n                    }\r\n                }, this);\r\n            }, 'removeClass');\r\n        });\r\n    }\r\n    getAttribute(attributeName) {\r\n        if (!is(attributeName)) {\r\n            return [];\r\n        }\r\n        return __classPrivateFieldGet(this, _elements).reduce((val, current) => {\r\n            let attr = current.getAttribute(attributeName);\r\n            if (attr != null) {\r\n                val.push(attr);\r\n            }\r\n            return val;\r\n        }, []);\r\n    }\r\n    setAttribute(attributeName, attributeValue) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!is(attributeName)) {\r\n                return false;\r\n            }\r\n            return this.call((element) => {\r\n                element.setAttribute(attributeName, attributeValue !== null && attributeValue !== void 0 ? attributeValue : \"\");\r\n            }, 'setAttribute');\r\n        });\r\n    }\r\n    setAttributeAs(attributeName, attributeValue) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!is(attributeName)) {\r\n                return false;\r\n            }\r\n            return this.call((element) => {\r\n                __classPrivateFieldGet(this, _utils).interactions.mutate(element.setAttribute, element, attributeName, attributeValue !== null && attributeValue !== void 0 ? attributeValue : \"\");\r\n            }, 'setAttributeAs');\r\n        });\r\n    }\r\n    removeAttribute(attributeName) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!is(attributeName)) {\r\n                return false;\r\n            }\r\n            return this.call((element) => {\r\n                element.removeAttribute(attributeName);\r\n            }, 'removeAttribute');\r\n        });\r\n    }\r\n    removeAttributeAs(attributeName) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!is(attributeName)) {\r\n                return false;\r\n            }\r\n            return this.call((element) => {\r\n                __classPrivateFieldGet(this, _utils).interactions.mutate(element.removeAttribute, element, attributeName);\r\n            }, 'removeAttributeAs');\r\n        });\r\n    }\r\n    toggleAttribute(attributeName, attributeValue) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!is(attributeName)) {\r\n                return false;\r\n            }\r\n            return this.call((element) => {\r\n                if (element.hasAttribute(attributeName)) {\r\n                    element.removeAttribute(attributeName);\r\n                }\r\n                else {\r\n                    element.setAttribute(attributeName, attributeValue !== null && attributeValue !== void 0 ? attributeValue : \"\");\r\n                }\r\n            }, 'toggleAttribute');\r\n        });\r\n    }\r\n    toggleAttributeAs(attributeName, attributeValue) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!is(attributeName)) {\r\n                return false;\r\n            }\r\n            return this.call((element) => {\r\n                __classPrivateFieldGet(this, _utils).interactions.fetch(() => {\r\n                    if (element.hasAttribute(attributeName)) {\r\n                        __classPrivateFieldGet(this, _utils).interactions.mutate(element.removeAttribute, element, attributeName);\r\n                    }\r\n                    else {\r\n                        __classPrivateFieldGet(this, _utils).interactions.mutate(element.setAttribute, element, attributeName, attributeValue !== null && attributeValue !== void 0 ? attributeValue : \"\");\r\n                    }\r\n                }, this);\r\n            }, 'toggleAttributeAs');\r\n        });\r\n    }\r\n    click(onClick) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!is(onClick)) {\r\n                return false;\r\n            }\r\n            return this.call((element) => {\r\n                //@ts-ignore\r\n                element.addEventListener('click', onClick);\r\n            }, 'click');\r\n        });\r\n    }\r\n    event(eventName, callback) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!is(eventName) || !is(callback)) {\r\n                return false;\r\n            }\r\n            return this.call((element) => {\r\n                element.addEventListener(eventName, callback);\r\n            }, 'event');\r\n        });\r\n    }\r\n    call(callback, functionName) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (__classPrivateFieldGet(this, _isLocked)) {\r\n                __classPrivateFieldGet(this, _logger).error(\"Element is locked\", functionName);\r\n            }\r\n            this.lock();\r\n            __classPrivateFieldGet(this, _elements).forEach((element, index) => {\r\n                callback(element, index);\r\n            });\r\n            this.unlock();\r\n            return true;\r\n        });\r\n    }\r\n    animate(className, timeout) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!is(className)) {\r\n                return false;\r\n            }\r\n            const delay = timeout !== null && timeout !== void 0 ? timeout : __classPrivateFieldGet(this, _utils).setup.animationTime;\r\n            return this.call((element) => {\r\n                this.change(() => {\r\n                    element.classList.add(className);\r\n                    element.classList.add(CLASSES.animProgress);\r\n                    setTimeout(() => {\r\n                        this.change(() => {\r\n                            element.classList.remove(className);\r\n                            element.classList.remove(CLASSES.animProgress);\r\n                        });\r\n                    }, delay);\r\n                });\r\n            });\r\n        });\r\n    }\r\n    open(openClass, animationClass, timeout) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!are(openClass, animationClass)) {\r\n                return false;\r\n            }\r\n            const delay = timeout !== null && timeout !== void 0 ? timeout : __classPrivateFieldGet(this, _utils).setup.animationTime;\r\n            const action = new CuiClassAction(animationClass);\r\n            return this.call((element) => {\r\n                __classPrivateFieldGet(this, _actionsHelper).performAction(element, action, delay !== null && delay !== void 0 ? delay : 0).then(() => {\r\n                    element.classList.add(openClass);\r\n                });\r\n            });\r\n        });\r\n    }\r\n    close(closeClass, animationClass, timeout) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!are(closeClass, animationClass)) {\r\n                return false;\r\n            }\r\n            const delay = timeout !== null && timeout !== void 0 ? timeout : __classPrivateFieldGet(this, _utils).setup.animationTime;\r\n            const action = new CuiClassAction(animationClass);\r\n            return this.call((element) => {\r\n                __classPrivateFieldGet(this, _actionsHelper).performAction(element, action, delay !== null && delay !== void 0 ? delay : 0).then(() => {\r\n                    element.classList.remove(closeClass);\r\n                });\r\n            });\r\n        });\r\n    }\r\n    emit(event, ...args) {\r\n        if (!is(event)) {\r\n            __classPrivateFieldGet(this, _logger).warning(\"Not enough data to emit event\", \"emit\");\r\n            return;\r\n        }\r\n        this.call((element) => {\r\n            let cuid = element.$cuid;\r\n            if (is(cuid)) {\r\n                __classPrivateFieldGet(this, _logger).debug(`Emitting event ${event} to ${cuid}`);\r\n                __classPrivateFieldGet(this, _utils).bus.emit(event, cuid, ...args);\r\n            }\r\n        }, \"emit\");\r\n    }\r\n    on(event, callback) {\r\n        let ids = [];\r\n        if (!are(event, callback)) {\r\n            __classPrivateFieldGet(this, _logger).error(\"Incorrect arguments\", \"on\");\r\n            return ids;\r\n        }\r\n        this.call((element) => {\r\n            let cuiElement = element;\r\n            if (is(cuiElement)) {\r\n                let disposeId = __classPrivateFieldGet(this, _utils).bus.on(event, callback, cuiElement);\r\n                if (disposeId != null)\r\n                    ids.push(disposeId);\r\n            }\r\n        }, \"on\");\r\n        return ids;\r\n    }\r\n    detach(event, id) {\r\n        if (!are(event, id)) {\r\n            __classPrivateFieldGet(this, _logger).error(\"Incorrect arguments\", \"detach\");\r\n        }\r\n        this.call((element) => {\r\n            let cuiElement = element;\r\n            if (is(cuiElement)) {\r\n                __classPrivateFieldGet(this, _utils).bus.detach(event, id, cuiElement);\r\n            }\r\n        }, \"detach\");\r\n    }\r\n    read(callback, ...args) {\r\n        __classPrivateFieldGet(this, _utils).interactions.fetch(callback, this, ...args);\r\n    }\r\n    change(callback, ...args) {\r\n        __classPrivateFieldGet(this, _utils).interactions.mutate(callback, this, ...args);\r\n    }\r\n    elements() {\r\n        return __classPrivateFieldGet(this, _elements);\r\n    }\r\n    count() {\r\n        return __classPrivateFieldGet(this, _elements).length;\r\n    }\r\n    lock() {\r\n        __classPrivateFieldSet(this, _isLocked, true);\r\n    }\r\n    unlock() {\r\n        __classPrivateFieldSet(this, _isLocked, false);\r\n    }\r\n    isLocked() {\r\n        return __classPrivateFieldGet(this, _isLocked);\r\n    }\r\n    refresh() {\r\n        return (Date.now() - __classPrivateFieldGet(this, _cDt)) < 360000;\r\n    }\r\n}\r\n_elements = new WeakMap(), _isLocked = new WeakMap(), _logger = new WeakMap(), _cDt = new WeakMap(), _utils = new WeakMap(), _actionsHelper = new WeakMap();\r\n","import { ITrainingsService, IActionsService, ISettingsService } from \"./interfaces\";\r\nimport { Training, StopwatchAction, Settings } from \"../models\";\r\nimport { BpdStorage } from \"../../../node_modules/bpd-storage/dist/index\";\r\nimport { ActionValidator, TrainingValidator } from \"../validators\";\r\nimport { is } from \"bpd-toolkit/dist/esm/index\";\r\n\r\nexport class TrainingsStorageService implements ITrainingsService {\r\n    #storage: BpdStorage;\r\n    #trainings: Training[];\r\n    #STORAGE_NAME: string;\r\n    #validator: TrainingValidator;\r\n    constructor() {\r\n        this.#storage = new BpdStorage(\"local\", \"BPD_TRAININGS\");\r\n        this.#STORAGE_NAME = \"Trainings\";\r\n        this.#trainings = [];\r\n        this.#validator = new TrainingValidator();\r\n    }\r\n\r\n    getAllTrainings(): Training[] {\r\n        return this.getTrainings();\r\n    }\r\n\r\n    addTraining(training: Training): boolean {\r\n        let result = false;\r\n\r\n        if (this.validate(training)) {\r\n            this.onAction((t: Training[]) => {\r\n                if (!is(training.id)) {\r\n                    training.id = \"00\" + this.getNextIndex();\r\n                    t.push(training)\r\n                    result = true;\r\n                    return t;\r\n                }\r\n                return null;\r\n            })\r\n        }\r\n        return result;\r\n    }\r\n\r\n    updateTraining(training: Training): boolean {\r\n        let result = false;\r\n\r\n        if (this.validate(training)) {\r\n            if (!is(training.id)) {\r\n                console.log(training)\r\n                result = this.addTraining(training)\r\n            } else {\r\n                this.onAction((t: Training[]) => {\r\n                    let idx = t.findIndex(item => item.id === training.id);\r\n                    if (idx > -1) {\r\n                        t[idx] = training;\r\n                        result = true;\r\n                        return t;\r\n                    }\r\n                    return null;\r\n                })\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Removes training from storage\r\n     * @param id Id of training\r\n     */\r\n    deleteTraining(id: string): boolean {\r\n        let result = false;\r\n        if (!is(id)) {\r\n            return false;\r\n        }\r\n        this.onAction((t: Training[]) => {\r\n            let idx = t.findIndex(item => item.id === id);\r\n            if (idx > -1) {\r\n                t.splice(idx, 1);\r\n                result = true;\r\n                return t;\r\n            }\r\n            return null;\r\n        })\r\n        return result;\r\n    }\r\n\r\n    getTraining(id: string): Training {\r\n        console.log(id)\r\n        let training = undefined;\r\n        this.onAction((t) => {\r\n            training = t.find(item => { return item.id === id });\r\n            return null;\r\n        })\r\n        console.log(training)\r\n        return training;\r\n    }\r\n\r\n    /**\r\n     * Removes all trainings from storage\r\n     */\r\n    clearTrainings(): void {\r\n        this.onAction((trainings: Training[]) => {\r\n            return [];\r\n        })\r\n    }\r\n\r\n    getCurrentTraining(): Training {\r\n        throw new Error(\"Method not implemented.\");\r\n    }\r\n\r\n    setCurrentTraining(training: Training): void {\r\n        throw new Error(\"Method not implemented.\");\r\n    }\r\n\r\n    private getTrainings(): Training[] {\r\n        if (this.#trainings.length === 0) {\r\n            let res = this.#storage.getAny(this.#STORAGE_NAME);\r\n            this.#trainings = res ?? [];\r\n        }\r\n        return this.#storage.getAny(this.#STORAGE_NAME) ?? [];\r\n    }\r\n\r\n    private setTrainings(t: Training[]): void {\r\n        this.#storage.setAny(this.#STORAGE_NAME, t);\r\n    }\r\n\r\n    private getNextIndex(): number {\r\n        let idx = this.#storage.getNumber(\"TRAININGS_INDEX\");\r\n        if (!idx || idx === NaN) {\r\n            idx = 1;\r\n        } else {\r\n            idx += 1;\r\n        }\r\n        this.#storage.setNumber(\"TRAININGS_INDEX\", idx);\r\n        return idx;\r\n    }\r\n\r\n    private validate(training: Training): boolean {\r\n        return this.#validator.validate(training).status;\r\n    }\r\n\r\n    private onAction(callback: (t: Training[]) => Training[] | null) {\r\n        let t = this.getTrainings();\r\n        let result = callback(t)\r\n        if (result !== null) {\r\n            this.setTrainings(result);\r\n        }\r\n    }\r\n}\r\n\r\nexport class ActionStorageService implements IActionsService {\r\n    #storage: BpdStorage;\r\n    #actions: StopwatchAction[];\r\n    #validator: ActionValidator;\r\n    constructor() {\r\n        this.#storage = new BpdStorage(\"local\", \"BPD_TRAININGS\");\r\n        this.#actions = [];\r\n        this.#validator = new ActionValidator();\r\n        this.getActionsFromStorage();\r\n    }\r\n\r\n    getAllActions(): StopwatchAction[] {\r\n        return [...this.#actions];\r\n    }\r\n\r\n    setAction(action: StopwatchAction): boolean {\r\n        if (!this.#validator.validate(action).status) {\r\n            return false;\r\n        }\r\n        if (!is(action.id)) {\r\n            action.id = \"000\" + this.getNextIndex();\r\n            this.#actions.push(action);\r\n        }\r\n        let existingIndex = this.getIndex(action);\r\n        if (existingIndex > -1) {\r\n            this.#actions[existingIndex] = action;\r\n            this.setActionsToStorage();\r\n            return true;\r\n        }\r\n        console.log(\"Unknown action id: \" + action.id);\r\n        return false;\r\n    }\r\n\r\n    removeAction(action: StopwatchAction): boolean {\r\n        if (!this.#validator.validate(action).status) {\r\n            return false;\r\n        }\r\n        let existingIndex = this.getIndex(action);\r\n        if (existingIndex < 0) {\r\n            console.log(\"Unknown action id: \" + action.id);\r\n            return false;\r\n        }\r\n        this.#actions.splice(existingIndex, 1);\r\n        this.setActionsToStorage();\r\n        return true;\r\n    }\r\n\r\n    clearActions(): void {\r\n        this.#actions = [];\r\n        this.setActionsToStorage();\r\n    }\r\n\r\n    getActionsById(...id: string[]): StopwatchAction[] | undefined {\r\n        if (!is(id)) {\r\n            return undefined;\r\n        }\r\n        return this.#actions.reduce((result: StopwatchAction[], action: StopwatchAction, index: number) => {\r\n            if (id.includes(action.id)) {\r\n                result.push(action);\r\n            }\r\n            return result;\r\n        }, []);\r\n    }\r\n\r\n    private getIndex(action: StopwatchAction): number {\r\n        return this.#actions.findIndex(item => item.id === action.id);\r\n    }\r\n\r\n    private getActionsFromStorage() {\r\n        let val = this.#storage.getAny(\"ACTIONS\");\r\n        this.#actions = val ?? [];\r\n    }\r\n\r\n    private setActionsToStorage() {\r\n        this.#storage.setAny(\"ACTIONS\", this.#actions);\r\n    }\r\n\r\n    private getNextIndex() {\r\n        let item = this.#storage.getNumber(\"ACTION_INDEX\");\r\n        if (!item) {\r\n            item = 5;\r\n        } else {\r\n            item = item + 1;\r\n        }\r\n        this.#storage.setNumber(\"ACTION_INDEX\", item);\r\n        return item;\r\n    }\r\n\r\n}\r\n\r\nexport class SettingsService implements ISettingsService {\r\n    #storage: BpdStorage;\r\n    constructor() {\r\n        this.#storage = new BpdStorage(\"local\", \"BPD_SETTINGS\");\r\n\r\n    }\r\n\r\n\r\n    setSettings(value: Settings): boolean {\r\n        this.#storage.setAny(\"SETTINGS\", value);\r\n        return true;\r\n    }\r\n\r\n    getSettings(): Settings {\r\n        return this.#storage.getAny(\"SETTINGS\") || {\r\n            darkMode: false,\r\n            soundEnabled: false\r\n        };\r\n    }\r\n\r\n    setSoundEnabled(flag: boolean): void {\r\n        let settings = this.getSettings();\r\n        if (flag !== settings.soundEnabled) {\r\n            settings.soundEnabled = flag;\r\n            this.setSettings(settings)\r\n        }\r\n    }\r\n\r\n    isSoundEnabled(): boolean {\r\n        return this.getSettings()?.soundEnabled;\r\n    }\r\n\r\n    setDarkMode(flag: boolean): void {\r\n        let settings = this.getSettings();\r\n        if (flag !== settings.darkMode) {\r\n            settings.darkMode = flag;\r\n            this.setSettings(settings)\r\n        }\r\n    }\r\n\r\n    isDarkMode(): boolean {\r\n        return this.getSettings()?.darkMode;\r\n    }\r\n\r\n    isWelcomeSet(): boolean {\r\n        return this.getSettings()?.isWelcome;\r\n    }\r\n\r\n    setIsWelcome(flag: boolean) {\r\n        let settings = this.getSettings();\r\n        if (flag !== settings.isWelcome) {\r\n            settings.isWelcome = flag;\r\n            this.setSettings(settings)\r\n        }\r\n    }\r\n\r\n    clearSettings(): void {\r\n        this.setSettings({\r\n            darkMode: false,\r\n            soundEnabled: false,\r\n            isWelcome: false\r\n        })\r\n    }\r\n}","var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n};\r\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n};\r\nvar _header, _body, _footer, _prefix, _switches, _reverse;\r\nimport { ElementBuilder } from \"cui-light-core/dist/esm/builders/element\";\r\nimport { is } from \"cui-light-core/dist/esm/utils/functions\";\r\nexport class DialogBuilder {\r\n    constructor(prefix, reverse, switches) {\r\n        _header.set(this, void 0);\r\n        _body.set(this, void 0);\r\n        _footer.set(this, void 0);\r\n        _prefix.set(this, void 0);\r\n        _switches.set(this, void 0);\r\n        _reverse.set(this, void 0);\r\n        __classPrivateFieldSet(this, _prefix, prefix);\r\n        __classPrivateFieldSet(this, _header, __classPrivateFieldSet(this, _footer, __classPrivateFieldSet(this, _body, undefined)));\r\n        __classPrivateFieldSet(this, _switches, switches !== null && switches !== void 0 ? switches : \"\");\r\n        __classPrivateFieldSet(this, _reverse, reverse);\r\n    }\r\n    createHeader(title, classes, elements) {\r\n        if (!is(classes)) {\r\n            classes = [];\r\n        }\r\n        if (!is(elements)) {\r\n            elements = [];\r\n        }\r\n        let headerBuilder = new ElementBuilder('div');\r\n        headerBuilder.setClasses(`${__classPrivateFieldGet(this, _prefix)}-dialog-header`, ...classes);\r\n        __classPrivateFieldSet(this, _header, headerBuilder.build());\r\n        let titleElement = new ElementBuilder('span').setClasses(this.getPrefixedString(\"-dialog-title\")).build(title);\r\n        __classPrivateFieldGet(this, _header).appendChild(titleElement);\r\n        // @ts-ignore\r\n        this.appendChildrens(__classPrivateFieldGet(this, _header), ...elements);\r\n    }\r\n    createFooter(classes, elements) {\r\n        if (!is(classes)) {\r\n            classes = [];\r\n        }\r\n        if (!is(elements)) {\r\n            elements = [];\r\n        }\r\n        __classPrivateFieldSet(this, _footer, new ElementBuilder('div').setClasses(this.getPrefixedString(\"-dialog-footer\"), ...classes).build());\r\n        // @ts-ignore\r\n        this.appendChildrens(__classPrivateFieldGet(this, _footer), ...elements);\r\n    }\r\n    createBody(classes, elements) {\r\n        if (!is(classes)) {\r\n            classes = [];\r\n        }\r\n        if (!is(elements)) {\r\n            elements = [];\r\n        }\r\n        __classPrivateFieldSet(this, _body, new ElementBuilder('div').setClasses(this.getPrefixedString(\"-dialog-body\"), ...classes).build());\r\n        // @ts-ignore\r\n        this.appendChildrens(__classPrivateFieldGet(this, _body), ...elements);\r\n    }\r\n    build(id) {\r\n        let classes = [this.getPrefixedString(\"-dialog\")];\r\n        if (__classPrivateFieldGet(this, _reverse)) {\r\n            classes.push(this.getPrefixedString('-reverse-auto'));\r\n        }\r\n        let dialog = new ElementBuilder('div').setId(id).setClasses(...classes).setAttributes({\r\n            [this.getPrefixedString('-dialog')]: __classPrivateFieldGet(this, _switches)\r\n        }).build();\r\n        let container = new ElementBuilder('div').setClasses(this.getPrefixedString(\"-dialog-container\")).build();\r\n        if (__classPrivateFieldGet(this, _header))\r\n            container.appendChild(__classPrivateFieldGet(this, _header));\r\n        if (__classPrivateFieldGet(this, _body))\r\n            container.appendChild(__classPrivateFieldGet(this, _body));\r\n        if (__classPrivateFieldGet(this, _footer))\r\n            container.appendChild(__classPrivateFieldGet(this, _footer));\r\n        dialog.appendChild(container);\r\n        return dialog;\r\n    }\r\n    appendChildrens(parent, ...elements) {\r\n        if (is(elements)) {\r\n            elements.forEach((element) => parent.appendChild(element));\r\n        }\r\n    }\r\n    getPrefixedString(str) {\r\n        return __classPrivateFieldGet(this, _prefix) + str;\r\n    }\r\n}\r\n_header = new WeakMap(), _body = new WeakMap(), _footer = new WeakMap(), _prefix = new WeakMap(), _switches = new WeakMap(), _reverse = new WeakMap();\r\n","var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n};\r\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n};\r\nvar _callbacks, _utils, _id, _manager, _attid, _id_1, _id_2, _id_3;\r\nimport { ElementManager } from \"../managers/element\";\r\nimport { DialogBuilder } from \"../builders/dialog\";\r\nimport { ElementBuilder } from \"cui-light-core/dist/esm/builders/element\";\r\nimport { is } from \"cui-light-core/dist/esm/utils/functions\";\r\nclass CuiAlertHandlerBase {\r\n    constructor(setup, id, data) {\r\n        _callbacks.set(this, void 0);\r\n        _utils.set(this, void 0);\r\n        _id.set(this, void 0);\r\n        _manager.set(this, void 0);\r\n        _attid.set(this, void 0);\r\n        __classPrivateFieldSet(this, _callbacks, {\r\n            \"yes\": data.onYes,\r\n            \"no\": data.onNo,\r\n            \"cancel\": data.onCancel,\r\n            \"ok\": data.onOk\r\n        });\r\n        this.content = data.message;\r\n        this.title = data.title;\r\n        this.prefix = setup.setup.prefix;\r\n        __classPrivateFieldSet(this, _utils, setup);\r\n        __classPrivateFieldSet(this, _id, id);\r\n        this.reverse = false;\r\n        __classPrivateFieldSet(this, _attid, null);\r\n        this.closeStr = `${__classPrivateFieldGet(this, _utils).setup.prefix}-close`;\r\n        this.iconStr = `${__classPrivateFieldGet(this, _utils).setup.prefix}-icon`;\r\n        __classPrivateFieldSet(this, _manager, undefined);\r\n    }\r\n    getId() {\r\n        return __classPrivateFieldGet(this, _id);\r\n    }\r\n    show(root) {\r\n        let element = document.getElementById(__classPrivateFieldGet(this, _id));\r\n        if (!is(element)) {\r\n            element = this.createElement();\r\n            root.appendChild(element);\r\n        }\r\n        else {\r\n            // @ts-ignore - already checked\r\n            this.updateElement(element);\r\n        }\r\n        setTimeout(() => {\r\n            // @ts-ignore - already checked\r\n            __classPrivateFieldSet(this, _manager, new ElementManager([element], __classPrivateFieldGet(this, _utils)));\r\n            let ids = __classPrivateFieldGet(this, _manager).on('closed', this.onClose.bind(this));\r\n            __classPrivateFieldSet(this, _attid, ids.length > 0 ? ids[0] : null);\r\n            __classPrivateFieldGet(this, _manager).emit(\"open\");\r\n        }, 100);\r\n    }\r\n    updateElement(element) {\r\n        let title = element.querySelector(`.${this.prefix}-dialog-title`);\r\n        let content = element.querySelector(`.${this.prefix}-dialog-body>p`);\r\n        __classPrivateFieldGet(this, _utils).interactions.mutate(() => {\r\n            if (title) {\r\n                title.innerHTML = this.title;\r\n            }\r\n            if (content) {\r\n                content.innerHTML = this.content;\r\n            }\r\n        }, null);\r\n    }\r\n    onClose(arg) {\r\n        try {\r\n            if (is(arg) && arg.state && __classPrivateFieldGet(this, _callbacks)) {\r\n                if (is(__classPrivateFieldGet(this, _callbacks)[arg.state])) {\r\n                    let callback = __classPrivateFieldGet(this, _callbacks)[arg.state];\r\n                    if (callback) {\r\n                        callback();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        finally {\r\n            if (__classPrivateFieldGet(this, _attid) != null) {\r\n                if (__classPrivateFieldGet(this, _manager))\r\n                    __classPrivateFieldGet(this, _manager).detach('closed', __classPrivateFieldGet(this, _attid));\r\n                __classPrivateFieldSet(this, _attid, null);\r\n            }\r\n            __classPrivateFieldSet(this, _manager, undefined);\r\n        }\r\n    }\r\n}\r\n_callbacks = new WeakMap(), _utils = new WeakMap(), _id = new WeakMap(), _manager = new WeakMap(), _attid = new WeakMap();\r\nexport class CuiAlertHandler extends CuiAlertHandlerBase {\r\n    constructor(setup, id, data) {\r\n        var _a;\r\n        super(setup, id, data);\r\n        _id_1.set(this, void 0);\r\n        __classPrivateFieldSet(this, _id_1, id);\r\n        this.reverse = (_a = data.reverse) !== null && _a !== void 0 ? _a : false;\r\n    }\r\n    createElement() {\r\n        let dialogBuilder = new DialogBuilder(this.prefix, this.reverse);\r\n        dialogBuilder.createHeader(this.title, [], [\r\n            new ElementBuilder('a').setClasses(`${this.prefix}-icon`).setAttributes({\r\n                [this.closeStr]: \"state: cancel\",\r\n                [this.iconStr]: \"close\"\r\n            }).build()\r\n        ]);\r\n        dialogBuilder.createBody([], [\r\n            new ElementBuilder('p').build(this.content)\r\n        ]);\r\n        dialogBuilder.createFooter([`${this.prefix}-flex`, `${this.prefix}-right`], [\r\n            new ElementBuilder('button').setClasses(`${this.prefix}-button`, `${this.prefix}-margin-small-right`).setAttributes({ [this.closeStr]: \"state: cancel\" }).build(\"Cancel\"),\r\n            new ElementBuilder('button').setClasses(`${this.prefix}-button`, `${this.prefix}-accent`).setAttributes({ [this.closeStr]: \"state: ok\" }).build(\"Ok\")\r\n        ]);\r\n        return dialogBuilder.build(__classPrivateFieldGet(this, _id_1));\r\n    }\r\n}\r\n_id_1 = new WeakMap();\r\nexport class CuiInfoAlertUpHandler extends CuiAlertHandlerBase {\r\n    constructor(setup, id, data) {\r\n        var _a;\r\n        super(setup, id, data);\r\n        _id_2.set(this, void 0);\r\n        __classPrivateFieldSet(this, _id_2, id);\r\n        this.content = data.message;\r\n        ;\r\n        this.title = data.title;\r\n        this.prefix = setup.setup.prefix;\r\n        this.reverse = (_a = data.reverse) !== null && _a !== void 0 ? _a : false;\r\n    }\r\n    createElement() {\r\n        let dialogBuilder = new DialogBuilder(this.prefix, this.reverse);\r\n        dialogBuilder.createHeader(this.title, []);\r\n        dialogBuilder.createBody([], [\r\n            new ElementBuilder('p').build(this.content)\r\n        ]);\r\n        dialogBuilder.createFooter([`${this.prefix}-flex`, `${this.prefix}-right`], [\r\n            new ElementBuilder('button').setClasses(`${this.prefix}-button`, `${this.prefix}-accent`).setAttributes({ [this.closeStr]: \"state: ok\" }).build(\"Ok\")\r\n        ]);\r\n        return dialogBuilder.build(__classPrivateFieldGet(this, _id_2));\r\n    }\r\n}\r\n_id_2 = new WeakMap();\r\nexport class CuiYesNoPopUpHandler extends CuiAlertHandlerBase {\r\n    constructor(setup, id, data) {\r\n        var _a;\r\n        super(setup, id, data);\r\n        _id_3.set(this, void 0);\r\n        __classPrivateFieldSet(this, _id_3, id);\r\n        this.content = data.message;\r\n        this.title = data.title;\r\n        this.prefix = setup.setup.prefix;\r\n        this.reverse = (_a = data.reverse) !== null && _a !== void 0 ? _a : false;\r\n    }\r\n    createElement() {\r\n        let dialogBuilder = new DialogBuilder(this.prefix, this.reverse);\r\n        dialogBuilder.createHeader(this.title, [], [\r\n            new ElementBuilder('a').setClasses(`${this.prefix}-icon`).setAttributes({\r\n                [this.closeStr]: \"state: cancel\",\r\n                [this.iconStr]: \"close\"\r\n            }).build()\r\n        ]);\r\n        dialogBuilder.createBody([], [\r\n            new ElementBuilder('p').build(this.content)\r\n        ]);\r\n        dialogBuilder.createFooter([`${this.prefix}-flex`, `${this.prefix}-right`], [\r\n            new ElementBuilder('button').setClasses(`${this.prefix}-button`, `${this.prefix}-margin-small-right`).setAttributes({ [this.closeStr]: \"state: no\" }).build(\"No\"),\r\n            new ElementBuilder('button').setClasses(`${this.prefix}-button`, `${this.prefix}-accent`).setAttributes({ [this.closeStr]: \"state: yes\" }).build(\"Yes\")\r\n        ]);\r\n        return dialogBuilder.build(__classPrivateFieldGet(this, _id_3));\r\n    }\r\n}\r\n_id_3 = new WeakMap();\r\nexport class CuiAlertFactory {\r\n    static get(id, type, data, utils) {\r\n        if (type === \"Info\") {\r\n            return new CuiInfoAlertUpHandler(utils, id, data);\r\n        }\r\n        else if (type === 'YesNoCancel') {\r\n            return new CuiYesNoPopUpHandler(utils, id, data);\r\n        }\r\n        else if (type === 'OkCancel') {\r\n            return new CuiAlertHandler(utils, id, data);\r\n        }\r\n        return undefined;\r\n    }\r\n}\r\n","var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n};\r\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n};\r\nvar _bus, _moveListener, _isLocked, _eventId, _firstEvent;\r\nimport { CuiMoveEventListener } from \"cui-light-core/dist/esm/listeners/move\";\r\nimport { EVENTS } from \"cui-light-core/dist/esm/utils/statics\";\r\nexport class CuiMoveObserver {\r\n    constructor(bus) {\r\n        _bus.set(this, void 0);\r\n        _moveListener.set(this, void 0);\r\n        _isLocked.set(this, void 0);\r\n        _eventId.set(this, void 0);\r\n        _firstEvent.set(this, void 0);\r\n        __classPrivateFieldSet(this, _bus, bus);\r\n        __classPrivateFieldSet(this, _moveListener, new CuiMoveEventListener());\r\n        __classPrivateFieldGet(this, _moveListener).setCallback(this.onMove.bind(this));\r\n        __classPrivateFieldSet(this, _firstEvent, undefined);\r\n        __classPrivateFieldSet(this, _isLocked, false);\r\n        __classPrivateFieldSet(this, _eventId, null);\r\n    }\r\n    attach() {\r\n        if (!__classPrivateFieldGet(this, _moveListener).isAttached()) {\r\n            __classPrivateFieldGet(this, _moveListener).attach();\r\n            __classPrivateFieldSet(this, _eventId, __classPrivateFieldGet(this, _bus).on(EVENTS.MOVE_LOCK, this.onMoveLock.bind(this)));\r\n        }\r\n    }\r\n    detach() {\r\n        if (__classPrivateFieldGet(this, _moveListener).isAttached()) {\r\n            __classPrivateFieldGet(this, _moveListener).detach();\r\n            __classPrivateFieldGet(this, _eventId) != null && __classPrivateFieldGet(this, _bus).detach(EVENTS.MOVE_LOCK, __classPrivateFieldGet(this, _eventId));\r\n        }\r\n    }\r\n    isAttached() {\r\n        return __classPrivateFieldGet(this, _moveListener).isAttached();\r\n    }\r\n    onMove(data) {\r\n        if (__classPrivateFieldGet(this, _isLocked)) {\r\n            return;\r\n        }\r\n        switch (data.type) {\r\n            case \"down\":\r\n                __classPrivateFieldSet(this, _firstEvent, data);\r\n                break;\r\n            case \"move\":\r\n                if (__classPrivateFieldGet(this, _firstEvent)) {\r\n                    __classPrivateFieldGet(this, _bus).emit(EVENTS.GLOBAL_MOVE, null, __classPrivateFieldGet(this, _firstEvent));\r\n                    __classPrivateFieldSet(this, _firstEvent, undefined);\r\n                }\r\n                __classPrivateFieldGet(this, _bus).emit(EVENTS.GLOBAL_MOVE, null, data);\r\n                break;\r\n            case \"up\":\r\n                if (__classPrivateFieldGet(this, _firstEvent)) {\r\n                    __classPrivateFieldSet(this, _firstEvent, undefined);\r\n                    return;\r\n                }\r\n                __classPrivateFieldGet(this, _bus).emit(EVENTS.GLOBAL_MOVE, null, data);\r\n                break;\r\n        }\r\n    }\r\n    onMoveLock(flag) {\r\n        __classPrivateFieldSet(this, _isLocked, flag);\r\n    }\r\n}\r\n_bus = new WeakMap(), _moveListener = new WeakMap(), _isLocked = new WeakMap(), _eventId = new WeakMap(), _firstEvent = new WeakMap();\r\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n};\r\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n};\r\nvar _interactions, _selector, _className, _activeCls, _animationTime, _lock, _animClsIn, _animClsOut;\r\nimport { is, sleep } from \"cui-light-core/dist/esm/utils/functions\";\r\nimport { CLASSES } from \"cui-light-core/dist/esm/utils/statics\";\r\nexport class CuiToastHandler {\r\n    constructor(interaction, prefix, animationTime) {\r\n        _interactions.set(this, void 0);\r\n        _selector.set(this, void 0);\r\n        _className.set(this, void 0);\r\n        _activeCls.set(this, void 0);\r\n        _animationTime.set(this, void 0);\r\n        _lock.set(this, void 0);\r\n        _animClsIn.set(this, void 0);\r\n        _animClsOut.set(this, void 0);\r\n        __classPrivateFieldSet(this, _interactions, interaction);\r\n        __classPrivateFieldSet(this, _selector, `.${prefix}-toast`);\r\n        __classPrivateFieldSet(this, _className, `${prefix}-toast`);\r\n        __classPrivateFieldSet(this, _activeCls, `${prefix}-active`);\r\n        __classPrivateFieldSet(this, _animationTime, animationTime);\r\n        __classPrivateFieldSet(this, _lock, false);\r\n        __classPrivateFieldSet(this, _animClsIn, `${prefix}-toast-animation-in`);\r\n        __classPrivateFieldSet(this, _animClsOut, `${prefix}-toast-animation-out`);\r\n    }\r\n    show(message) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (__classPrivateFieldGet(this, _lock)) {\r\n                return false;\r\n            }\r\n            __classPrivateFieldSet(this, _lock, true);\r\n            let toastElement = document.querySelector(__classPrivateFieldGet(this, _selector));\r\n            if (!is(toastElement)) {\r\n                toastElement = document.createElement('div');\r\n                toastElement.classList.add(__classPrivateFieldGet(this, _className));\r\n                document.body.appendChild(toastElement);\r\n                yield sleep(10);\r\n            }\r\n            __classPrivateFieldGet(this, _interactions).mutate(() => {\r\n                //@ts-ignore\r\n                toastElement.textContent = message;\r\n                //@ts-ignore\r\n                toastElement.classList.add(CLASSES.animProgress);\r\n                //@ts-ignore\r\n                toastElement.classList.add(__classPrivateFieldGet(this, _animClsIn));\r\n            }, this);\r\n            yield sleep(__classPrivateFieldGet(this, _animationTime));\r\n            __classPrivateFieldGet(this, _interactions).mutate(() => {\r\n                //@ts-ignore\r\n                toastElement.classList.remove(CLASSES.animProgress);\r\n                //@ts-ignore\r\n                toastElement.classList.remove(__classPrivateFieldGet(this, _animClsIn));\r\n                //@ts-ignore\r\n                toastElement.classList.add(__classPrivateFieldGet(this, _activeCls));\r\n            }, this);\r\n            yield sleep(3000);\r\n            __classPrivateFieldGet(this, _interactions).mutate(() => {\r\n                //@ts-ignore\r\n                toastElement.classList.add(CLASSES.animProgress);\r\n                //@ts-ignore\r\n                toastElement.classList.add(__classPrivateFieldGet(this, _animClsOut));\r\n            }, this);\r\n            setTimeout(() => {\r\n                __classPrivateFieldGet(this, _interactions).mutate(() => {\r\n                    //@ts-ignore\r\n                    toastElement.classList.remove(CLASSES.animProgress);\r\n                    //@ts-ignore\r\n                    toastElement.classList.remove(__classPrivateFieldGet(this, _animClsOut));\r\n                    //@ts-ignore\r\n                    toastElement.classList.remove(__classPrivateFieldGet(this, _activeCls));\r\n                }, this);\r\n                __classPrivateFieldSet(this, _lock, false);\r\n            }, __classPrivateFieldGet(this, _animationTime));\r\n            return true;\r\n        });\r\n    }\r\n}\r\n_interactions = new WeakMap(), _selector = new WeakMap(), _className = new WeakMap(), _activeCls = new WeakMap(), _animationTime = new WeakMap(), _lock = new WeakMap(), _animClsIn = new WeakMap(), _animClsOut = new WeakMap();\r\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n};\r\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n};\r\nvar _elements, _log, _isLocked, _toggleClass, _interactions;\r\nimport { CLASSES } from \"cui-light-core/dist/esm/utils/statics\";\r\nimport { CuiLoggerFactory } from \"cui-light-core/dist/esm/factories/logger\";\r\nimport { is } from \"cui-light-core/dist/esm/utils/functions\";\r\nexport class CollectionManagerHelper {\r\n    constructor(interactions) {\r\n        _elements.set(this, void 0);\r\n        _log.set(this, void 0);\r\n        _isLocked.set(this, void 0);\r\n        _toggleClass.set(this, void 0);\r\n        _interactions.set(this, void 0);\r\n        __classPrivateFieldSet(this, _interactions, interactions);\r\n        __classPrivateFieldSet(this, _log, CuiLoggerFactory.get('CollectionManager'));\r\n        __classPrivateFieldSet(this, _elements, []);\r\n        __classPrivateFieldSet(this, _isLocked, false);\r\n        __classPrivateFieldSet(this, _toggleClass, \"\");\r\n    }\r\n    setElements(elements) {\r\n        __classPrivateFieldSet(this, _elements, elements);\r\n    }\r\n    setToggle(className) {\r\n        __classPrivateFieldSet(this, _toggleClass, className);\r\n    }\r\n    addAnimationClass(currentElement, nextElement, animIn, animOut) {\r\n        nextElement.classList.add(CLASSES.animProgress);\r\n        currentElement.classList.add(animOut);\r\n        nextElement.classList.add(animIn);\r\n    }\r\n    setFinalClasses(currentElement, nextElement, animIn, animOut) {\r\n        nextElement.classList.remove(CLASSES.animProgress);\r\n        currentElement.classList.remove(animOut);\r\n        nextElement.classList.remove(animIn);\r\n        currentElement.classList.remove(__classPrivateFieldGet(this, _toggleClass));\r\n        nextElement.classList.add(__classPrivateFieldGet(this, _toggleClass));\r\n    }\r\n    verifyIndex(index, current, count) {\r\n        return index >= 0 && index !== current && index < count;\r\n    }\r\n    setCurrent(newIndex, current) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.lock();\r\n            __classPrivateFieldGet(this, _log).debug(`Switching index from: ${current} to ${newIndex}`);\r\n            if (current > -1)\r\n                __classPrivateFieldGet(this, _elements)[current].classList.remove(__classPrivateFieldGet(this, _toggleClass));\r\n            __classPrivateFieldGet(this, _elements)[newIndex].classList.add(__classPrivateFieldGet(this, _toggleClass));\r\n            this.unlock();\r\n            return true;\r\n        });\r\n    }\r\n    setCurrentWithAnimation(newIndex, animClassIn, animClassOut, duration, current) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.lock();\r\n            __classPrivateFieldGet(this, _log).debug(`Switching index from: ${current} to ${newIndex}`);\r\n            const currentElement = __classPrivateFieldGet(this, _elements)[current];\r\n            const nextElement = __classPrivateFieldGet(this, _elements)[newIndex];\r\n            __classPrivateFieldGet(this, _interactions).mutate(this.addAnimationClass, this, currentElement, nextElement, animClassIn, animClassOut);\r\n            setTimeout(() => {\r\n                __classPrivateFieldGet(this, _interactions).mutate(this.setFinalClasses, this, currentElement, nextElement, animClassIn, animClassOut);\r\n                this.unlock();\r\n            }, duration);\r\n            return true;\r\n        });\r\n    }\r\n    getCurrentIndex() {\r\n        if (!is(__classPrivateFieldGet(this, _toggleClass))) {\r\n            return -1;\r\n        }\r\n        let len = this.count();\r\n        for (let i = 0; i < len; i++) {\r\n            if (__classPrivateFieldGet(this, _elements)[i].classList.contains(__classPrivateFieldGet(this, _toggleClass))) {\r\n                return i;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n    elements() {\r\n        return __classPrivateFieldGet(this, _elements);\r\n    }\r\n    check() {\r\n        if (__classPrivateFieldGet(this, _isLocked)) {\r\n            __classPrivateFieldGet(this, _log).warning(\"Object locked. Operation in progress\", \"Check\");\r\n            return false;\r\n        }\r\n        else if (!is(__classPrivateFieldGet(this, _toggleClass))) {\r\n            __classPrivateFieldGet(this, _log).warning(\"Toggle is not set. Call setToggleClass\", \"Check\");\r\n            return false;\r\n        }\r\n        else if (this.count() <= 0) {\r\n            __classPrivateFieldGet(this, _log).warning(\"Elements list is empty\", \"Check\");\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    count() {\r\n        return __classPrivateFieldGet(this, _elements) ? __classPrivateFieldGet(this, _elements).length : -1;\r\n    }\r\n    lock() {\r\n        __classPrivateFieldSet(this, _isLocked, true);\r\n    }\r\n    unlock() {\r\n        __classPrivateFieldSet(this, _isLocked, false);\r\n    }\r\n}\r\n_elements = new WeakMap(), _log = new WeakMap(), _isLocked = new WeakMap(), _toggleClass = new WeakMap(), _interactions = new WeakMap();\r\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n};\r\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n};\r\nvar _log, _cDt, _helper;\r\nimport { CuiLoggerFactory } from \"cui-light-core/dist/esm/factories/logger\";\r\nimport { CollectionManagerHelper } from \"../helpers/collection\";\r\nexport class CollectionManager {\r\n    constructor(elements, interactions) {\r\n        _log.set(this, void 0);\r\n        _cDt.set(this, void 0);\r\n        _helper.set(this, void 0);\r\n        __classPrivateFieldSet(this, _log, CuiLoggerFactory.get('CollectionManager'));\r\n        __classPrivateFieldSet(this, _helper, new CollectionManagerHelper(interactions));\r\n        __classPrivateFieldGet(this, _helper).setElements(elements);\r\n        __classPrivateFieldSet(this, _cDt, Date.now());\r\n    }\r\n    setToggle(className) {\r\n        __classPrivateFieldGet(this, _helper).setToggle(className);\r\n    }\r\n    setElements(elements) {\r\n        __classPrivateFieldGet(this, _helper).setElements(elements);\r\n    }\r\n    click(callback) {\r\n        __classPrivateFieldGet(this, _helper).elements().forEach((element, index) => {\r\n            element.addEventListener('click', () => {\r\n                this.set(index).then(() => {\r\n                    if (callback) {\r\n                        callback(element, index);\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    }\r\n    next() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!__classPrivateFieldGet(this, _helper).check()) {\r\n                return false;\r\n            }\r\n            let newIdx = __classPrivateFieldGet(this, _helper).getCurrentIndex() + 1;\r\n            return this.set(newIdx >= this.length() ? 0 : newIdx);\r\n        });\r\n    }\r\n    previous() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!__classPrivateFieldGet(this, _helper).check()) {\r\n                return false;\r\n            }\r\n            let newIdx = __classPrivateFieldGet(this, _helper).getCurrentIndex() - 1;\r\n            return this.set(newIdx < 0 ? this.length() - 1 : newIdx);\r\n        });\r\n    }\r\n    set(index) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let current = __classPrivateFieldGet(this, _helper).getCurrentIndex();\r\n            if (!__classPrivateFieldGet(this, _helper).check() || !__classPrivateFieldGet(this, _helper).verifyIndex(index, current, this.length())) {\r\n                return false;\r\n            }\r\n            return __classPrivateFieldGet(this, _helper).setCurrent(index, current);\r\n        });\r\n    }\r\n    setWithAnimation(index, animClassIn, animClassOut, duration) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let current = __classPrivateFieldGet(this, _helper).getCurrentIndex();\r\n            if (!__classPrivateFieldGet(this, _helper).check() || !__classPrivateFieldGet(this, _helper).verifyIndex(index, current, this.length())) {\r\n                return false;\r\n            }\r\n            return __classPrivateFieldGet(this, _helper).setCurrentWithAnimation(index, animClassIn, animClassOut, duration, current);\r\n        });\r\n    }\r\n    getCurrentIndex() {\r\n        return __classPrivateFieldGet(this, _helper).getCurrentIndex();\r\n    }\r\n    length() {\r\n        return __classPrivateFieldGet(this, _helper).count();\r\n    }\r\n    refresh() {\r\n        return this.length() > 0 && Date.now() - __classPrivateFieldGet(this, _cDt) > 360000;\r\n    }\r\n}\r\n_log = new WeakMap(), _cDt = new WeakMap(), _helper = new WeakMap();\r\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n};\r\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n};\r\nvar _plugins, _mutated, _log;\r\nimport { CuiLoggerFactory } from \"cui-light-core/dist/esm/factories/logger\";\r\nimport { is } from \"cui-light-core/dist/esm/utils/functions\";\r\nexport class CuiPluginManager {\r\n    constructor(plugins) {\r\n        _plugins.set(this, void 0);\r\n        _mutated.set(this, void 0);\r\n        _log.set(this, void 0);\r\n        __classPrivateFieldSet(this, _plugins, plugins !== null && plugins !== void 0 ? plugins : []);\r\n        __classPrivateFieldSet(this, _log, CuiLoggerFactory.get(\"CuiPluginManager\"));\r\n        __classPrivateFieldSet(this, _mutated, []);\r\n    }\r\n    init(utils) {\r\n        __classPrivateFieldGet(this, _log).debug(\"Plugins initialization started: \" + __classPrivateFieldGet(this, _plugins).length);\r\n        __classPrivateFieldSet(this, _mutated, __classPrivateFieldGet(this, _plugins).filter((plugin) => {\r\n            return is(plugin.mutation);\r\n        }));\r\n        __classPrivateFieldGet(this, _plugins).forEach(plugin => {\r\n            plugin.init(utils);\r\n            utils.setup.plugins[plugin.description] = plugin.setup;\r\n        });\r\n        __classPrivateFieldGet(this, _log).debug(\"Plugins have been initialized\");\r\n    }\r\n    get(name) {\r\n        if (!is(name)) {\r\n            return undefined;\r\n        }\r\n        return __classPrivateFieldGet(this, _plugins).find(p => p.name === name);\r\n    }\r\n    onMutation(mutation) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let tasks = [];\r\n            __classPrivateFieldGet(this, _mutated).forEach((plugin) => {\r\n                tasks.push(plugin.mutation(mutation));\r\n            });\r\n            let result = yield Promise.all(tasks);\r\n            return result.find(val => {\r\n                val === false;\r\n            }) ? false : true;\r\n        });\r\n    }\r\n}\r\n_plugins = new WeakMap(), _mutated = new WeakMap(), _log = new WeakMap();\r\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n};\r\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n};\r\nvar _log, _mutationObserver, _toastManager, _utils, _plugins, _components, _rootElement, _moveObserver, _mutatedAttributes;\r\nimport { is, joinAttributesForQuery, are, registerCuiElement, addCuiArgument } from \"cui-light-core/dist/esm/utils/functions\";\r\nimport { STATICS, EVENTS, CSS_VARIABLES } from \"cui-light-core/dist/esm/utils/statics\";\r\nimport { CuiMutationObserver } from \"cui-light-core/dist/esm/observers/mutations\";\r\nimport { CuiLoggerFactory } from \"cui-light-core/dist/esm/factories/logger\";\r\nimport { CuiUtils } from \"cui-light-core/dist/esm/models/utils\";\r\nimport { CuiInstanceInitError } from \"cui-light-core/dist/esm/models/errors\";\r\nimport { CuiAlertFactory } from \"./handlers/alert\";\r\nimport { CuiMoveObserver } from \"./observers/move\";\r\nimport { ElementManager } from \"./managers/element\";\r\nimport { CuiToastHandler } from \"./managers/toast\";\r\nimport { CollectionManager } from \"./managers/collection\";\r\nimport { CuiPluginManager } from \"./managers/plugins\";\r\nexport class CuiInstance {\r\n    constructor(setup, plugins, components) {\r\n        _log.set(this, void 0);\r\n        _mutationObserver.set(this, void 0);\r\n        _toastManager.set(this, void 0);\r\n        _utils.set(this, void 0);\r\n        _plugins.set(this, void 0);\r\n        _components.set(this, void 0);\r\n        _rootElement.set(this, void 0);\r\n        _moveObserver.set(this, void 0);\r\n        _mutatedAttributes.set(this, void 0);\r\n        STATICS.prefix = setup.prefix;\r\n        STATICS.logLevel = setup.logLevel;\r\n        __classPrivateFieldSet(this, _plugins, new CuiPluginManager(plugins));\r\n        __classPrivateFieldSet(this, _components, components !== null && components !== void 0 ? components : []);\r\n        __classPrivateFieldSet(this, _utils, new CuiUtils(setup));\r\n        __classPrivateFieldSet(this, _log, CuiLoggerFactory.get('CuiInstance'));\r\n        __classPrivateFieldSet(this, _rootElement, setup.root);\r\n        __classPrivateFieldSet(this, _moveObserver, new CuiMoveObserver(__classPrivateFieldGet(this, _utils).bus));\r\n        __classPrivateFieldSet(this, _mutationObserver, undefined);\r\n        __classPrivateFieldSet(this, _toastManager, undefined);\r\n        __classPrivateFieldSet(this, _mutatedAttributes, []);\r\n    }\r\n    init() {\r\n        var _a;\r\n        __classPrivateFieldGet(this, _log).debug(\"Instance started\", \"init\");\r\n        // Init elements\r\n        if (!is(window.MutationObserver)) {\r\n            throw new CuiInstanceInitError(\"Mutation observer does not exists\");\r\n        }\r\n        __classPrivateFieldSet(this, _toastManager, new CuiToastHandler(__classPrivateFieldGet(this, _utils).interactions, __classPrivateFieldGet(this, _utils).setup.prefix, (_a = __classPrivateFieldGet(this, _utils).setup.animationTimeLong) !== null && _a !== void 0 ? _a : 0));\r\n        __classPrivateFieldSet(this, _mutatedAttributes, __classPrivateFieldGet(this, _components).map(x => { return x.attribute; })); // MUTATED_ATTRIBUTES; \r\n        const initElements = is(__classPrivateFieldGet(this, _mutatedAttributes)) ? __classPrivateFieldGet(this, _rootElement).querySelectorAll(joinAttributesForQuery(__classPrivateFieldGet(this, _mutatedAttributes))) : null;\r\n        if (is(initElements)) {\r\n            //@ts-ignore initElements already checked\r\n            __classPrivateFieldGet(this, _log).debug(`Initiating ${initElements.length} elements`);\r\n            try {\r\n                //@ts-ignore initElements already checked\r\n                initElements.forEach((item) => {\r\n                    registerCuiElement(item, __classPrivateFieldGet(this, _components), __classPrivateFieldGet(this, _mutatedAttributes), __classPrivateFieldGet(this, _utils));\r\n                });\r\n            }\r\n            catch (e) {\r\n                __classPrivateFieldGet(this, _log).exception(e);\r\n            }\r\n        }\r\n        __classPrivateFieldGet(this, _log).debug(\"Init plugins\", \"init\");\r\n        // Init plugins\r\n        __classPrivateFieldGet(this, _plugins).init(__classPrivateFieldGet(this, _utils));\r\n        if (are(__classPrivateFieldGet(this, _components), __classPrivateFieldGet(this, _mutatedAttributes))) {\r\n            __classPrivateFieldGet(this, _log).debug(\"Init mutation observer\", \"init\");\r\n            __classPrivateFieldSet(this, _mutationObserver, new CuiMutationObserver(__classPrivateFieldGet(this, _rootElement), __classPrivateFieldGet(this, _utils)));\r\n            __classPrivateFieldGet(this, _mutationObserver).setComponents(__classPrivateFieldGet(this, _components)).setAttributes(__classPrivateFieldGet(this, _mutatedAttributes));\r\n            __classPrivateFieldGet(this, _mutationObserver).setPlugins(__classPrivateFieldGet(this, _plugins));\r\n            __classPrivateFieldGet(this, _mutationObserver).start();\r\n        }\r\n        __classPrivateFieldGet(this, _log).debug(\"Setting CSS globals\", 'init');\r\n        __classPrivateFieldGet(this, _utils).interactions.mutate(() => {\r\n            __classPrivateFieldGet(this, _utils).setProperty(CSS_VARIABLES.animationTimeLong, `${__classPrivateFieldGet(this, _utils).setup.animationTimeLong}ms`);\r\n            __classPrivateFieldGet(this, _utils).setProperty(CSS_VARIABLES.animationTime, `${__classPrivateFieldGet(this, _utils).setup.animationTime}ms`);\r\n            __classPrivateFieldGet(this, _utils).setProperty(CSS_VARIABLES.animationTimeShort, `${__classPrivateFieldGet(this, _utils).setup.animationTimeShort}ms`);\r\n        }, null);\r\n        __classPrivateFieldGet(this, _moveObserver).attach();\r\n        __classPrivateFieldGet(this, _utils).bus.emit(EVENTS.INSTANCE_INITIALIZED, null);\r\n        return this;\r\n    }\r\n    finish() {\r\n        if (__classPrivateFieldGet(this, _mutationObserver))\r\n            __classPrivateFieldGet(this, _mutationObserver).stop();\r\n        __classPrivateFieldGet(this, _moveObserver).detach();\r\n        __classPrivateFieldGet(this, _utils).bus.emit(EVENTS.INSTANCE_FINISHED, null);\r\n    }\r\n    get(selector) {\r\n        const elements = this.all(selector);\r\n        if (!elements) {\r\n            return undefined;\r\n        }\r\n        const newElement = new ElementManager(elements, __classPrivateFieldGet(this, _utils));\r\n        return newElement;\r\n    }\r\n    collection(selector) {\r\n        const elements = this.all(selector);\r\n        if (!is(elements)) {\r\n            return undefined;\r\n        }\r\n        // @ts-ignore already checked\r\n        let manager = new CollectionManager(elements, __classPrivateFieldGet(this, _utils).interactions);\r\n        return manager;\r\n    }\r\n    toast(message) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!are(message, __classPrivateFieldGet(this, _toastManager))) {\r\n                return false;\r\n            }\r\n            //@ts-ignore toast manager exists\r\n            return __classPrivateFieldGet(this, _toastManager).show(message);\r\n        });\r\n    }\r\n    select(selector) {\r\n        return document.querySelector(selector);\r\n    }\r\n    all(selector) {\r\n        const nodes = document.querySelectorAll(selector);\r\n        if (!is(nodes)) {\r\n            return undefined;\r\n        }\r\n        return [...nodes];\r\n    }\r\n    getUtils() {\r\n        return __classPrivateFieldGet(this, _utils);\r\n    }\r\n    on(event, callback, element) {\r\n        if (!are(event, callback)) {\r\n            __classPrivateFieldGet(this, _log).error(\"Incorrect arguments\", \"on\");\r\n        }\r\n        __classPrivateFieldGet(this, _utils).bus.on(event, callback, element);\r\n    }\r\n    detach(event, id) {\r\n        if (!are(event, id)) {\r\n            __classPrivateFieldGet(this, _log).error(\"Incorrect arguments\", \"detach\");\r\n        }\r\n        __classPrivateFieldGet(this, _utils).bus.detach(event, id);\r\n    }\r\n    detachAll(event) {\r\n        if (!is(event)) {\r\n            __classPrivateFieldGet(this, _log).error(\"Incorrect arguments\", \"detachAll\");\r\n        }\r\n        __classPrivateFieldGet(this, _utils).bus.detachAll(event);\r\n    }\r\n    emit(event, element, ...args) {\r\n        if (!are(event, element)) {\r\n            __classPrivateFieldGet(this, _log).warning(\"Not enough data to emit event\", \"emit\");\r\n            return;\r\n        }\r\n        let el = typeof element === 'string' ? document.querySelector(element) : element;\r\n        let cuid = el.$cuid;\r\n        if (!is(cuid)) {\r\n            __classPrivateFieldGet(this, _log).warning(\"Element is not a cUI element\", \"emit\");\r\n            return;\r\n        }\r\n        __classPrivateFieldGet(this, _utils).bus.emit(event, cuid, ...args);\r\n    }\r\n    alert(id, type, data) {\r\n        let popup = CuiAlertFactory.get(id, type, data, __classPrivateFieldGet(this, _utils));\r\n        if (!popup) {\r\n            __classPrivateFieldGet(this, _log).error(\"Possibly incorrect alert type\");\r\n            return;\r\n        }\r\n        popup.show(__classPrivateFieldGet(this, _rootElement));\r\n    }\r\n    getPlugin(name) {\r\n        return __classPrivateFieldGet(this, _plugins).get(name);\r\n    }\r\n    createCuiElement(element, arg, data) {\r\n        if (!is(arg) || !__classPrivateFieldGet(this, _mutatedAttributes).includes(arg)) {\r\n            __classPrivateFieldGet(this, _log).error(\"Element cannot be created: Unknown attribute\");\r\n            return false;\r\n        }\r\n        if (!addCuiArgument(element, arg, data)) {\r\n            __classPrivateFieldGet(this, _log).error(\"Element cannot be created: Missing data\");\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n}\r\n_log = new WeakMap(), _mutationObserver = new WeakMap(), _toastManager = new WeakMap(), _utils = new WeakMap(), _plugins = new WeakMap(), _components = new WeakMap(), _rootElement = new WeakMap(), _moveObserver = new WeakMap(), _mutatedAttributes = new WeakMap();\r\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n};\r\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n};\r\nvar _window;\r\nimport { CuiSetupInit } from \"cui-light-core/dist/esm/models/setup\";\r\nimport { is } from \"cui-light-core/dist/esm/utils/functions\";\r\nimport { CuiInstance } from \"./instance\";\r\nimport { ICONS } from \"cui-light-core/dist/esm/utils/statics\";\r\nimport { SWIPE_ANIMATIONS_DEFINITIONS } from \"cui-light-core/dist/esm/animation/definitions\";\r\nexport class CuiInitializer {\r\n    constructor() {\r\n        _window.set(this, void 0);\r\n        __classPrivateFieldSet(this, _window, window);\r\n    }\r\n    init(setup) {\r\n        var _a, _b;\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let settings = Object.assign(Object.assign({}, new CuiSetupInit()), setup.setup);\r\n            const appPrefix = settings.app;\r\n            const result = {\r\n                result: false\r\n            };\r\n            if (is(__classPrivateFieldGet(this, _window)[appPrefix])) {\r\n                result.message = \"Instance is already initialized\";\r\n                return result;\r\n            }\r\n            if (is(setup.icons)) {\r\n                for (let icon in setup.icons) {\r\n                    ICONS[icon] = setup.icons[icon];\r\n                }\r\n            }\r\n            if (is(setup.swipeAnimations)) {\r\n                for (let animation in setup.swipeAnimations) {\r\n                    SWIPE_ANIMATIONS_DEFINITIONS[animation] = setup.swipeAnimations[animation];\r\n                }\r\n            }\r\n            try {\r\n                __classPrivateFieldGet(this, _window)[appPrefix] = new CuiInstance(settings, (_a = setup.plugins) !== null && _a !== void 0 ? _a : [], (_b = setup.components) !== null && _b !== void 0 ? _b : []);\r\n                __classPrivateFieldGet(this, _window)[appPrefix].init();\r\n            }\r\n            catch (e) {\r\n                console.error(e);\r\n                result.message = \"An error occured during initialization\";\r\n                return result;\r\n            }\r\n            result.result = true;\r\n            return result;\r\n        });\r\n    }\r\n}\r\n_window = new WeakMap();\r\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n};\r\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n};\r\nvar _isInitialized;\r\nimport { is } from \"cui-light-core/dist/esm/utils/functions\";\r\nimport { CuiInitializer } from \"./initializer\";\r\nimport { GetComponents } from \"cui-light-components/dist/esm/module\";\r\nimport { GetPlugins } from \"cui-light-plugins/dist/esm/module\";\r\nexport class CuiInit {\r\n    constructor() {\r\n        _isInitialized.set(this, void 0);\r\n        __classPrivateFieldSet(this, _isInitialized, false);\r\n    }\r\n    init(data) {\r\n        var _a, _b;\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (__classPrivateFieldGet(this, _isInitialized)) {\r\n                console.log(\"Module is already initialized\");\r\n                return false;\r\n            }\r\n            const initializer = new CuiInitializer();\r\n            const pluginList = GetPlugins({\r\n                autoLight: true,\r\n                autoPrint: true\r\n            });\r\n            const componentList = GetComponents({\r\n                prefix: (_a = data.setup) === null || _a === void 0 ? void 0 : _a.prefix\r\n            });\r\n            let appPlugins = pluginList;\r\n            if (data.plugins) {\r\n                appPlugins = Object.assign(Object.assign({}, pluginList), data.plugins);\r\n            }\r\n            let result = yield initializer.init({\r\n                setup: data.setup,\r\n                icons: data.icons,\r\n                plugins: appPlugins,\r\n                // @ts-ignore already checked\r\n                components: is(data.components) ? [...componentList, ...data.components] : componentList,\r\n                swipeAnimations: data.swipeAnimations\r\n            });\r\n            if (result.result) {\r\n                __classPrivateFieldSet(this, _isInitialized, true);\r\n                return true;\r\n            }\r\n            else {\r\n                console.error(`A cUI instance failed to initialize: [${(_b = result.message) !== null && _b !== void 0 ? _b : \"#\"}]`);\r\n            }\r\n            console.log(\"Cui Light failed to init\");\r\n            return false;\r\n        });\r\n    }\r\n}\r\n_isInitialized = new WeakMap();\r\n","import * as React from \"react\";\r\nimport * as ReactDOM from \"react-dom\";\r\nimport '../styles/styles.scss';\r\nimport { App } from \"./ui/app\";\r\nimport { CuiIconsPack } from 'bpd-cui-icons/index';\r\nimport { Flow, FlowFactory } from '../node_modules/bpd-flow/dist/index';\r\nimport { TrainingsStorageService, ActionStorageService, SettingsService } from './core/services/storage';\r\nimport { TrainingsFlow, TrainingsFlowInput, TrainingsFlowOutput } from \"./app/flow/trainings\";\r\nimport { ActionsFlowInput, ActionsFlowOutput, ActionsFlow } from \"./app/flow/actions\";\r\nimport { SettingsFlow, SettingsFlowInput, SettingsFlowOutput } from \"./app/flow/settings\";\r\nimport { CuiSetupInit } from \"cui-light-core/dist/esm/models/setup\";\r\nimport { CuiInstance } from \"cui-light/dist/esm/index\";\r\nimport { CuiInitData } from \"cui-light/dist/esm/initializer\";\r\nimport { CuiInit } from \"../../cui-light/dist/esm/init\";\r\n\r\n\r\ndeclare global {\r\n    interface Window {\r\n        // cuiInit: CuiInit;\r\n        $cui: CuiInstance;\r\n        $flow: Flow<any, any>;\r\n        $actionsFlow: Flow<ActionsFlowInput, ActionsFlowOutput>;\r\n        $settingsFlow: Flow<SettingsFlowInput, SettingsFlowOutput>;\r\n    }\r\n}\r\n\r\nconst rootElement = document.getElementById('root');\r\nconst app_icons = require(\"../static/icons/all.json\");\r\nconst setup = new CuiSetupInit();\r\nsetup.logLevel = 'debug';\r\nsetup.root = rootElement;\r\nsetup.busSetup = [\r\n    {\r\n        name: \"MoveQueue\",\r\n        eventsDef: [\"global_move\"],\r\n        handler: 'tasked',\r\n        priority: 0\r\n    },\r\n    {\r\n        name: \"InteractQueue\",\r\n        eventsDef: [\"open\", \"close\", \"switch\"],\r\n        handler: 'tasked',\r\n        priority: 0\r\n    },\r\n    {\r\n        name: \"ResponsesQueue\",\r\n        eventsDef: [\"opened\", \"closed\", \"switched\", \"resize\", \"offset\"],\r\n        handler: 'tasked',\r\n        priority: 1\r\n    },\r\n    {\r\n        name: \"GlobalSimple\",\r\n        eventsDef: [\"keydown\", \"scroll\", \"intersection\", \"windowclick\"],\r\n        handler: 'tasked',\r\n        priority: 2\r\n    },\r\n]\r\nconst cuiSetup: CuiInitData = {\r\n    setup: setup,\r\n    icons: {\r\n        ...CuiIconsPack,\r\n        ...app_icons\r\n    }\r\n};\r\n\r\nconst service = new TrainingsStorageService();\r\nconst traningsFlow = new TrainingsFlow(service);\r\nconst actionsService = new ActionStorageService();\r\nconst actionsFlow = new ActionsFlow(actionsService);\r\nconst settingsService = new SettingsService();\r\nconst settingsFlow = new SettingsFlow(settingsService);\r\n\r\nwindow.$flow = FlowFactory.create<TrainingsFlowInput, TrainingsFlowOutput>(traningsFlow.getActions());\r\nwindow.$actionsFlow = FlowFactory.create<ActionsFlowInput, ActionsFlowOutput>(actionsFlow.getActions());\r\nwindow.$settingsFlow = FlowFactory.create<SettingsFlowInput, SettingsFlowOutput>(settingsFlow.getActions());\r\n\r\nnew CuiInit().init(cuiSetup).then((result) => {\r\n    ReactDOM.render(<App />, rootElement);\r\n});\r\n\r\n"],"sourceRoot":""}